#include "../include/integral.h"

int test_integral_kinetic_ammonia_ccpvdz(int, char**) {
    // initialize the system
    System system("../example/molecule/ammonia.xyz", "CC-PVDZ", 0, 1);

    // calculate the integral
    libint2::initialize();
    Matrix I = Integral::Kinetic(system);
    libint2::finalize();

    // create the expectation integral
    Matrix Iexp(system.shells.nbf(), system.shells.nbf()); Iexp << 22.14431404669646, -5.92085848359279, 0.12260559392481, -0.00000000000000, 0.00000000000000, -0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00447911605389, 0.01954909055142, -0.00224628326758, -0.00491121098579, -0.00413692598618, 0.00447912706750, 0.01954909707881, -0.00564130741279, 0.00240629738608, 0.00294397450194, 0.00447912549870, 0.01954909614904, 0.00318175210867, -0.00335358639859, 0.00499111982322, -5.92085848359279, 2.24146690301069, 0.37137922825820, -0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, -0.00000000000000, -0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.12248004611010, 0.11803897092624, -0.09889486875267, -0.21622097838935, -0.18213230644023, 0.12248010929311, 0.11803899841965, -0.24835984625213, 0.10593779156394, 0.12960914929291, 0.12248010029319, 0.11803899450343, 0.14007771279984, -0.14764277553597, 0.21973573844475, 0.12260559392481, 0.37137922825820, 0.33720000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.14408588045857, 0.13097477040485, -0.06699684048885, -0.14648002047230, -0.12338647329581, 0.14408593109449, 0.13097479758978, -0.16825262279401, 0.07176808792813, 0.08780436787876, 0.14408592388180, 0.13097479371751, 0.09489635191482, -0.10002134176022, 0.14886108251577, -0.00000000000000, -0.00000000000000, 0.00000000000000, 1.87220870107809, 0.00000000000000, -0.00000000000000, 0.56257028619001, -0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.08076165476598, 0.03838922850624, 0.10932647886073, -0.19746496854174, -0.16633330599815, 0.20282093951436, 0.09640883204897, -0.36997159834966, 0.24296883466883, 0.29725920751434, -0.11439326501733, -0.05437565579790, 0.01844363603663, 0.19098512560838, -0.28424186320783, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 1.87220870107809, -0.00000000000000, -0.00000000000000, 0.56257028619001, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.17657502588448, 0.08393313679390, -0.19746496854174, -0.23208914266818, -0.36366649367424, -0.08651318938756, -0.04112314816042, 0.24296883466883, 0.09600464624423, -0.12679579425310, 0.12057120873978, 0.05731227747174, 0.19098512560838, -0.00165662161885, 0.29959268158161, -0.00000000000000, -0.00000000000000, 0.00000000000000, -0.00000000000000, -0.00000000000000, 1.87220870107809, 0.00000000000000, 0.00000000000000, 0.56257028619001, 0.00000000000000, -0.00000000000000, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.14873680141329, 0.07070052085098, -0.16633330599815, -0.36366649367424, -0.10668930956398, -0.10584420076730, -0.05031194411960, 0.29725920751434, -0.12679579425310, 0.04451511830840, -0.17944530974465, -0.08529747267677, -0.28424186320783, 0.29959268158161, -0.24623886809610, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.56257028619001, -0.00000000000000, 0.00000000000000, 0.54625000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.09515578828318, 0.05186592132675, 0.16904603604248, -0.10089284347717, -0.08498641724172, 0.23896962051447, 0.13025353657278, -0.07584661791065, 0.12414255468144, 0.15188169080907, -0.13478152739768, -0.07346444661373, 0.12261034924817, 0.09758199211113, -0.14523061502745, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.56257028619001, 0.00000000000000, 0.00000000000000, 0.54625000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.20804595730297, 0.11339820150207, -0.10089284347717, -0.00539702146772, -0.18581192854170, -0.10193239458876, -0.05555959313127, 0.12414255468144, 0.16223939630430, -0.06478507353792, 0.14206056337032, 0.07743198103730, 0.09758199211113, 0.11234031812549, 0.15307396634959, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.56257028619001, 0.00000000000000, 0.00000000000000, 0.54625000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.17524613167240, 0.09552022259633, -0.08498641724172, -0.18581192854170, 0.05867482796906, -0.12470876306748, -0.06797415251439, 0.15188169080907, -0.06478507353792, 0.13593132454683, -0.21142777005334, -0.11524149062293, -0.14523061502745, 0.15307396634959, -0.01262660152461, 0.00000000000000, -0.00000000000000, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 2.85950000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.11263050279827, 0.01211246825790, 0.22638304884310, -0.25237473078169, -0.37911350919369, -0.13858510343219, -0.01490365932312, 0.42432331122916, 0.22515539326233, -0.33195419281452, -0.10893451941773, -0.01171499004360, 0.01313719104840, 0.01721585875608, -0.44237666520428, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 2.85950000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.20742889402560, 0.02230724210792, -0.37911350919369, -0.46479248503237, -0.26596875706547, 0.07232206667692, 0.00777762845070, -0.33195419281452, -0.11749966598794, -0.03854074809162, -0.17088233801036, -0.01837695616705, -0.44237666520428, 0.02700600517466, -0.39879848301007, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 2.85950000000000, 0.00000000000000, 0.00000000000000, 0.01492038442229, 0.00160456251389, -0.14140911691711, -0.30917294293054, 0.37019381542334, -0.05976936174045, -0.00642769087932, -0.01230640028480, 0.00524929004405, -0.44234277552545, 0.08385307070133, 0.00901769148698, 0.37874771148484, -0.39920243009268, -0.16669338290825, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 2.85950000000000, 0.00000000000000, 0.09487355668714, 0.01020285726635, 0.19069225905786, -0.37911350919369, -0.12164844280251, -0.16955136684791, -0.01823381984563, 0.51913658555331, -0.33195419281452, 0.09035467069087, 0.16212650418880, 0.01743533998707, -0.01955199206754, -0.44237666520428, 0.37836446223191, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 2.85950000000000, -0.09736869633121, -0.01047118865959, 0.37565406313306, -0.04315143957272, 0.32774237204511, 0.13289228254728, 0.01429144443887, -0.11348541201990, 0.47195609638075, 0.31831812577063, -0.00573241476502, -0.00061647292573, -0.29486167606634, -0.27950321736702, -0.02327899862110, 0.00447911605389, 0.12248004611010, 0.14408588045857, 0.08076165476598, 0.17657502588448, 0.14873680141329, 0.09515578828318, 0.20804595730297, 0.17524613167240, 0.11263050279827, 0.20742889402560, 0.01492038442229, 0.09487355668714, -0.09736869633121, 0.49928923249979, 0.20997888717551, -0.00000000000000, -0.00000000000000, -0.00000000000000, 0.02191861262973, 0.04940508998191, -0.00436809463851, 0.00941505612593, 0.00911061072669, 0.02191860600224, 0.04940508177822, 0.00698394264687, 0.00200419197037, 0.01174454164275, 0.01954909055142, 0.11803897092624, 0.13097477040485, 0.03838922850624, 0.08393313679390, 0.07070052085098, 0.05186592132675, 0.11339820150207, 0.09552022259633, 0.01211246825790, 0.02230724210792, 0.00160456251389, 0.01020285726635, -0.01047118865959, 0.20997888717551, 0.18300000000000, -0.00000000000000, -0.00000000000000, -0.00000000000000, 0.04940508998191, 0.06308935089426, -0.01643452131634, 0.03542321158337, 0.03427776607049, 0.04940508177822, 0.06308934341341, 0.02627640415415, 0.00754057713225, 0.04418769431738, -0.00224628326758, -0.09889486875267, -0.06699684048885, 0.10932647886073, -0.19746496854174, -0.16633330599815, 0.16904603604248, -0.10089284347717, -0.08498641724172, 0.22638304884310, -0.37911350919369, -0.14140911691711, 0.19069225905786, 0.37565406313306, -0.00000000000000, -0.00000000000000, 1.81750000000000, 0.00000000000000, 0.00000000000000, 0.00436809463851, 0.01643452131634, -0.02279756992263, 0.00189343227106, 0.00183220621611, -0.00698394264687, -0.02627640415415, -0.02416472469106, -0.00064442535130, -0.00377632506560, -0.00491121098579, -0.21622097838935, -0.14648002047230, -0.19746496854174, -0.23208914266818, -0.36366649367424, -0.10089284347717, -0.00539702146772, -0.18581192854170, -0.25237473078169, -0.46479248503237, -0.30917294293054, -0.37911350919369, -0.04315143957272, -0.00000000000000, -0.00000000000000, 0.00000000000000, 1.81750000000000, 0.00000000000000, -0.00941505612593, -0.03542321158337, 0.00189343227106, -0.02600024824096, -0.00394916451830, -0.00200419197037, -0.00754057713225, -0.00064442535130, -0.02210404826659, -0.00108369738365, -0.00413692598618, -0.18213230644023, -0.12338647329581, -0.16633330599815, -0.36366649367424, -0.10668930956398, -0.08498641724172, -0.18581192854170, 0.05867482796906, -0.37911350919369, -0.26596875706547, 0.37019381542334, -0.12164844280251, 0.32774237204511, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 1.81750000000000, -0.00911061072669, -0.03427776607049, 0.00183220621611, -0.00394916451830, -0.02574058044744, -0.01174454164275, -0.04418769431738, -0.00377632506560, -0.00108369738365, -0.02826957067307, 0.00447912706750, 0.12248010929311, 0.14408593109449, 0.20282093951436, -0.08651318938756, -0.10584420076730, 0.23896962051447, -0.10193239458876, -0.12470876306748, -0.13858510343219, 0.07232206667692, -0.05976936174045, -0.16955136684791, 0.13289228254728, 0.02191861262973, 0.04940508998191, 0.00436809463851, -0.00941505612593, -0.00911061072669, 0.49928923249979, 0.20997888717551, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.02191839014453, 0.04940481458289, 0.01135176223366, -0.00741067977010, 0.00263387454117, 0.01954909707881, 0.11803899841965, 0.13097479758978, 0.09640883204897, -0.04112314816042, -0.05031194411960, 0.13025353657278, -0.05555959313127, -0.06797415251439, -0.01490365932312, 0.00777762845070, -0.00642769087932, -0.01823381984563, 0.01429144443887, 0.04940508998191, 0.06308935089426, 0.01643452131634, -0.03542321158337, -0.03427776607049, 0.20997888717551, 0.18300000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.04940481458289, 0.06308909976110, 0.04271069755934, -0.02788248166714, 0.00990988153394, -0.00564130741279, -0.24835984625213, -0.16825262279401, -0.36997159834966, 0.24296883466883, 0.29725920751434, -0.07584661791065, 0.12414255468144, 0.15188169080907, 0.42432331122916, -0.33195419281452, -0.01230640028480, 0.51913658555331, -0.11348541201990, -0.00436809463851, -0.01643452131634, -0.02279756992263, 0.00189343227106, 0.00183220621611, -0.00000000000000, -0.00000000000000, 1.81750000000000, 0.00000000000000, 0.00000000000000, -0.01135176223366, -0.04271069755934, -0.02785095052145, 0.00387242231187, -0.00137632104696, 0.00240629738608, 0.10593779156394, 0.07176808792813, 0.24296883466883, 0.09600464624423, -0.12679579425310, 0.12414255468144, 0.16223939630430, -0.06478507353792, 0.22515539326233, -0.11749966598794, 0.00524929004405, -0.33195419281452, 0.47195609638075, 0.00941505612593, 0.03542321158337, 0.00189343227106, -0.02600024824096, -0.00394916451830, 0.00000000000000, 0.00000000000000, 0.00000000000000, 1.81750000000000, 0.00000000000000, 0.00741067977010, 0.02788248166714, 0.00387242231187, -0.02444713303019, 0.00089849261550, 0.00294397450194, 0.12960914929291, 0.08780436787876, 0.29725920751434, -0.12679579425310, 0.04451511830840, 0.15188169080907, -0.06478507353792, 0.13593132454683, -0.33195419281452, -0.03854074809162, -0.44234277552545, 0.09035467069087, 0.31831812577063, 0.00911061072669, 0.03427776607049, 0.00183220621611, -0.00394916451830, -0.02574058044744, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 1.81750000000000, -0.00263387454117, -0.00990988153394, -0.00137632104696, 0.00089849261550, -0.02223846937025, 0.00447912549870, 0.12248010029319, 0.14408592388180, -0.11439326501733, 0.12057120873978, -0.17944530974465, -0.13478152739768, 0.14206056337032, -0.21142777005334, -0.10893451941773, -0.17088233801036, 0.08385307070133, 0.16212650418880, -0.00573241476502, 0.02191860600224, 0.04940508177822, -0.00698394264687, -0.00200419197037, -0.01174454164275, 0.02191839014453, 0.04940481458289, -0.01135176223366, 0.00741067977010, -0.00263387454117, 0.49928923249979, 0.20997888717551, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.01954909614904, 0.11803899450343, 0.13097479371751, -0.05437565579790, 0.05731227747174, -0.08529747267677, -0.07346444661373, 0.07743198103730, -0.11524149062293, -0.01171499004360, -0.01837695616705, 0.00901769148698, 0.01743533998707, -0.00061647292573, 0.04940508177822, 0.06308934341341, -0.02627640415415, -0.00754057713225, -0.04418769431738, 0.04940481458289, 0.06308909976110, -0.04271069755934, 0.02788248166714, -0.00990988153394, 0.20997888717551, 0.18300000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00318175210867, 0.14007771279984, 0.09489635191482, 0.01844363603663, 0.19098512560838, -0.28424186320783, 0.12261034924817, 0.09758199211113, -0.14523061502745, 0.01313719104840, -0.44237666520428, 0.37874771148484, -0.01955199206754, -0.29486167606634, 0.00698394264687, 0.02627640415415, -0.02416472469106, -0.00064442535130, -0.00377632506560, 0.01135176223366, 0.04271069755934, -0.02785095052145, 0.00387242231187, -0.00137632104696, 0.00000000000000, 0.00000000000000, 1.81750000000000, 0.00000000000000, 0.00000000000000, -0.00335358639859, -0.14764277553597, -0.10002134176022, 0.19098512560838, -0.00165662161885, 0.29959268158161, 0.09758199211113, 0.11234031812549, 0.15307396634959, 0.01721585875608, 0.02700600517466, -0.39920243009268, -0.44237666520428, -0.27950321736702, 0.00200419197037, 0.00754057713225, -0.00064442535130, -0.02210404826659, -0.00108369738365, -0.00741067977010, -0.02788248166714, 0.00387242231187, -0.02444713303019, 0.00089849261550, -0.00000000000000, -0.00000000000000, 0.00000000000000, 1.81750000000000, 0.00000000000000, 0.00499111982322, 0.21973573844475, 0.14886108251577, -0.28424186320783, 0.29959268158161, -0.24623886809610, -0.14523061502745, 0.15307396634959, -0.01262660152461, -0.44237666520428, -0.39879848301007, -0.16669338290825, 0.37836446223191, -0.02327899862110, 0.01174454164275, 0.04418769431738, -0.00377632506560, -0.00108369738365, -0.02826957067307, 0.00263387454117, 0.00990988153394, -0.00137632104696, 0.00089849261550, -0.02223846937025, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 1.81750000000000;

    // print the results
    std::cout << std::fixed << std::setprecision(14) << "COMPUTED INTEGRAL: " << I << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "COMPUTED INTEGRAL NORM: " << I.norm() << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "EXPECTED INTEGRAL: " << Iexp << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "EXPECTED INTEGRAL NORM: " << Iexp.norm() << std::endl;

    // return success or failure based on the error
    return (I - Iexp).norm() > 1e-8;
}
