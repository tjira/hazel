#include "../include/integral.h"

int test_integral_kinetic_ethylene_321g(int, char**) {
    // initialize the system
    System system("../example/molecule/ethylene.xyz", "3-21G", 0, 1);

    // calculate the integral
    libint2::initialize();
    Matrix I = Integral::Kinetic(system);
    libint2::finalize();

    // create the expectation integral
    Matrix Iexp(system.shells.nbf(), system.shells.nbf()); Iexp << 16.57897377972110, -1.43502704208436, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.10274966905493, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000200438103, -0.03021938262710, 0.05011161327299, 0.00069523059301, 0.01327366299569, 0.00739073637172, -0.05923343324601, -0.00082178345960, -0.01568986866781, -0.04465697840200, 0.02199127876106, -0.04465686044023, 0.02199118731089, -0.00006931868093, -0.00485612117724, -0.00006931158639, -0.00485609096638, -1.43502704208436, 1.35736735247949, -0.00000000000000, -0.00000000000000, -0.00000000000000, 0.34641224940510, -0.00000000000000, -0.00000000000000, 0.00000000000000, -0.03021938262710, -0.05256814672878, -0.04229564328438, -0.00058679462188, -0.01120335344393, 0.05297015270037, -0.23792506135074, -0.00330088717346, -0.06302205968494, -0.01202977728216, 0.10520909719173, -0.01203035929293, 0.10520877509061, -0.00809744168261, -0.01718204488519, -0.00809704275065, -0.01718216761601, -0.00000000000000, -0.00000000000000, 2.58667015032044, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.41750973612682, 0.00000000000000, 0.00000000000000, -0.05011161327299, 0.04229564328438, -0.26010589307783, -0.00362205484869, -0.06915394100454, 0.10362137491160, -0.19256835786696, -0.00403338965735, -0.07700733480432, -0.08008776411528, -0.06209596264969, -0.09485399391728, -0.07354553164256, -0.01476649323230, 0.00363633102991, -0.01402228774599, 0.00345265913950, 0.00000000000000, -0.00000000000000, 0.00000000000000, 2.58667015032044, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.41750973612682, 0.00000000000000, -0.00069523059301, 0.00058679462188, -0.00362205484869, 0.00091840239911, -0.00095941703476, 0.00143760588061, -0.00403338965735, 0.09809888425790, -0.00106837221046, -0.14340214573053, -0.11118670103402, 0.14098063568325, 0.10931006038262, 0.00696272017802, -0.00171460854230, -0.00736214424770, 0.00181275517117, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 2.58667015032044, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.41750973612682, -0.01327366299569, 0.01120335344393, -0.06915394100454, -0.00095941703476, -0.01734897884425, 0.02744743423513, -0.07700733480432, -0.00106837221046, 0.07775698728180, -0.04362169845840, -0.03382203746243, -0.00278070179193, -0.00215603142452, -0.00278263073198, 0.00068523828348, -0.00483976031076, 0.00119167734771, 0.10274966905493, 0.34641224940510, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.29378550000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00739073637172, 0.05297015270037, -0.10362137491160, -0.00143760588061, -0.02744743423513, 0.09746699429437, -0.21677388182831, -0.00300744327649, -0.05741949352103, 0.09081991296432, 0.14062400874880, 0.09081959140951, 0.14062375366535, -0.01741770277891, 0.00082062498748, -0.01741770353956, 0.00081997075969, 0.00000000000000, -0.00000000000000, 0.41750973612682, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.48964250000000, 0.00000000000000, 0.00000000000000, 0.05923343324601, 0.23792506135074, -0.19256835786696, -0.00403338965735, -0.07700733480432, 0.21677388182831, -0.14372955845509, -0.00484283844620, -0.09246170425168, -0.13922740532581, -0.11044645074792, -0.16489883092568, -0.13081124619458, 0.00007745429720, 0.06613840930149, 0.00007249281781, 0.06280622203200, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.41750973612682, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.48964250000000, 0.00000000000000, 0.00082178345960, 0.00330088717346, -0.00403338965735, 0.09809888425790, -0.00106837221046, 0.00300744327649, -0.00484283844620, 0.20527081463004, -0.00128278060272, -0.24929536850945, -0.19776127103231, 0.24508764520344, 0.19442357544915, -0.00003652137237, -0.03118568706470, 0.00003806102052, 0.03297525158722, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.41750973612682, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.48964250000000, 0.01568986866781, 0.06302205968494, -0.07700733480432, -0.00106837221046, 0.07775698728180, 0.05741949352103, -0.09246170425168, -0.00128278060272, 0.18084656378560, -0.07583350539699, -0.06015727650221, -0.00483410825107, -0.00383481023493, 0.00001459565953, 0.01246326852228, 0.00002502072906, 0.02167742284039, -0.00000200438103, -0.03021938262710, -0.05011161327299, -0.00069523059301, -0.01327366299569, 0.00739073637172, 0.05923343324601, 0.00082178345960, 0.01568986866781, 16.57897377972110, -1.43502704208436, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.10274966905493, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00006932125485, -0.00485613213652, -0.00006931117818, -0.00485608922793, -0.04465684634596, 0.02199117638433, -0.04465697364606, 0.02199127507398, -0.03021938262710, -0.05256814672878, 0.04229564328438, 0.00058679462188, 0.01120335344393, 0.05297015270037, 0.23792506135074, 0.00330088717346, 0.06302205968494, -1.43502704208436, 1.35736735247949, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.34641224940510, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00809758641046, -0.01718200035766, -0.00809701979607, -0.01718217467768, -0.01203042883201, 0.10520873660561, -0.01202980074764, 0.10520908420531, 0.05011161327299, -0.04229564328438, -0.26010589307783, -0.00362205484869, -0.06915394100454, -0.10362137491160, -0.19256835786696, -0.00403338965735, -0.07700733480432, 0.00000000000000, 0.00000000000000, 2.58667015032044, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.41750973612682, 0.00000000000000, 0.00000000000000, 0.01402221932821, -0.00345319714460, 0.01476511889082, -0.00363553919865, 0.09486669800616, 0.07355545214003, 0.08010678784299, 0.06211073271251, 0.00069523059301, -0.00058679462188, -0.00362205484869, 0.00091840239911, -0.00095941703476, -0.00143760588061, -0.00403338965735, 0.09809888425790, -0.00106837221046, -0.00000000000000, 0.00000000000000, 0.00000000000000, 2.58667015032044, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.41750973612682, 0.00000000000000, 0.00736225668080, -0.00181307417555, -0.00696275090612, 0.00171440230430, -0.14097303216410, -0.10930426944668, 0.14340914659063, 0.11119216501202, 0.01327366299569, -0.01120335344393, -0.06915394100454, -0.00095941703476, -0.01734897884425, -0.02744743423513, -0.07700733480432, -0.00106837221046, 0.07775698728180, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 2.58667015032044, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.41750973612682, 0.00484300027622, -0.00119266674795, 0.00278550748201, -0.00068586116467, 0.00272086145682, 0.00210963592992, 0.04356347039047, 0.03377690128776, 0.00739073637172, 0.05297015270037, 0.10362137491160, 0.00143760588061, 0.02744743423513, 0.09746699429437, 0.21677388182831, 0.00300744327649, 0.05741949352103, 0.10274966905493, 0.34641224940510, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.29378550000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.01741770250023, 0.00082086233110, -0.01741770358299, 0.00081993311505, 0.09081955298980, 0.14062372318768, 0.09081989999993, 0.14062399846439, -0.05923343324601, -0.23792506135074, -0.19256835786696, -0.00403338965735, -0.07700733480432, -0.21677388182831, -0.14372955845509, -0.00484283844620, -0.09246170425168, 0.00000000000000, -0.00000000000000, 0.41750973612682, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.48964250000000, 0.00000000000000, 0.00000000000000, -0.00007393415222, -0.06280445316882, -0.00007626902675, -0.06613344868738, 0.16492107034400, 0.13082890530390, 0.13926052073007, 0.11047272540688, -0.00082178345960, -0.00330088717346, -0.00403338965735, 0.09809888425790, -0.00106837221046, -0.00300744327649, -0.00484283844620, 0.20527081463004, -0.00128278060272, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.41750973612682, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.48964250000000, 0.00000000000000, -0.00003881854886, -0.03297498734709, 0.00003596599791, 0.03118638821523, -0.24507465573043, -0.19441329637301, 0.24930761761177, 0.19777099667503, -0.01568986866781, -0.06302205968494, -0.07700733480432, -0.00106837221046, 0.07775698728180, -0.05741949352103, -0.09246170425168, -0.00128278060272, 0.18084656378560, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.41750973612682, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.48964250000000, -0.00002553541000, -0.02169142964643, -0.00001438850213, -0.01247637878786, 0.00473008329737, 0.00375228961649, 0.07573230352560, 0.06007699761536, -0.04465697840200, -0.01202977728216, -0.08008776411528, -0.14340214573053, -0.04362169845840, 0.09081991296432, -0.13922740532581, -0.24929536850945, -0.07583350539699, -0.00006932125485, -0.00809758641046, 0.01402221932821, 0.00736225668080, 0.00484300027622, -0.01741770250023, -0.00007393415222, -0.00003881854886, -0.00002553541000, 1.54940494556963, 0.29315085381580, -0.01692593925876, -0.00988805158695, -0.00068324483497, -0.01314142839154, -0.00000815539483, -0.00437550783951, 0.02199127876106, 0.10520909719173, -0.06209596264969, -0.11118670103402, -0.03382203746243, 0.14062400874880, -0.11044645074792, -0.19776127103231, -0.06015727650221, -0.00485613213652, -0.01718200035766, -0.00345319714460, -0.00181307417555, -0.00119266674795, 0.00082086233110, -0.06280445316882, -0.03297498734709, -0.02169142964643, 0.29315085381580, 0.27478737000000, -0.00988805158695, 0.02462990570390, -0.01314142839154, -0.01209794349407, -0.00437550783951, -0.01333176793700, -0.04465686044023, -0.01203035929293, -0.09485399391728, 0.14098063568325, -0.00278070179193, 0.09081959140951, -0.16489883092568, 0.24508764520344, -0.00483410825107, -0.00006931117818, -0.00809701979607, 0.01476511889082, -0.00696275090612, 0.00278550748201, -0.01741770358299, -0.00007626902675, 0.00003596599791, -0.00001438850213, -0.01692593925876, -0.00988805158695, 1.54940494556963, 0.29315085381580, -0.00000815512548, -0.00437546650492, -0.00068306937568, -0.01314081178111, 0.02199118731089, 0.10520877509061, -0.07354553164256, 0.10931006038262, -0.00215603142452, 0.14062375366535, -0.13081124619458, 0.19442357544915, -0.00383481023493, -0.00485608922793, -0.01718217467768, -0.00363553919865, 0.00171440230430, -0.00068586116467, 0.00081993311505, -0.06613344868738, 0.03118638821523, -0.01247637878786, -0.00988805158695, 0.02462990570390, 0.29315085381580, 0.27478737000000, -0.00437546650492, -0.01333172911509, -0.01314081178111, -0.01209881877597, -0.00006931868093, -0.00809744168261, -0.01476649323230, 0.00696272017802, -0.00278263073198, -0.01741770277891, 0.00007745429720, -0.00003652137237, 0.00001459565953, -0.04465684634596, -0.01203042883201, 0.09486669800616, -0.14097303216410, 0.00272086145682, 0.09081955298980, 0.16492107034400, -0.24507465573043, 0.00473008329737, -0.00068324483497, -0.01314142839154, -0.00000815512548, -0.00437546650492, 1.54940494556963, 0.29315085381580, -0.01692613013499, -0.00988792617906, -0.00485612117724, -0.01718204488519, 0.00363633102991, -0.00171460854230, 0.00068523828348, 0.00082062498748, 0.06613840930149, -0.03118568706470, 0.01246326852228, 0.02199117638433, 0.10520873660561, 0.07355545214003, -0.10930426944668, 0.00210963592992, 0.14062372318768, 0.13082890530390, -0.19441329637301, 0.00375228961649, -0.01314142839154, -0.01209794349407, -0.00437546650492, -0.01333172911509, 0.29315085381580, 0.27478737000000, -0.00988792617906, 0.02463020294694, -0.00006931158639, -0.00809704275065, -0.01402228774599, -0.00736214424770, -0.00483976031076, -0.01741770353956, 0.00007249281781, 0.00003806102052, 0.00002502072906, -0.04465697364606, -0.01202980074764, 0.08010678784299, 0.14340914659063, 0.04356347039047, 0.09081989999993, 0.13926052073007, 0.24930761761177, 0.07573230352560, -0.00000815539483, -0.00437550783951, -0.00068306937568, -0.01314081178111, -0.01692613013499, -0.00988792617906, 1.54940494556963, 0.29315085381580, -0.00485609096638, -0.01718216761601, 0.00345265913950, 0.00181275517117, 0.00119167734771, 0.00081997075969, 0.06280622203200, 0.03297525158722, 0.02167742284039, 0.02199127507398, 0.10520908420531, 0.06211073271251, 0.11119216501202, 0.03377690128776, 0.14062399846439, 0.11047272540688, 0.19777099667503, 0.06007699761536, -0.00437550783951, -0.01333176793700, -0.01314081178111, -0.01209881877597, -0.00988792617906, 0.02463020294694, 0.29315085381580, 0.27478737000000;

    // print the results
    std::cout << std::fixed << std::setprecision(14) << "COMPUTED INTEGRAL: " << I << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "COMPUTED INTEGRAL NORM: " << I.norm() << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "EXPECTED INTEGRAL: " << Iexp << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "EXPECTED INTEGRAL NORM: " << Iexp.norm() << std::endl;

    // return success or failure based on the error
    return (I - Iexp).norm() > 1e-8;
}
