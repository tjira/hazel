#include "../include/integral.h"

int test_integral_overlap_ethane_631g(int, char**) {
    // initialize the system
    System system("../example/molecule/ethane.xyz", "6-31G", 0, 1);

    // calculate the integral
    libint2::initialize();
    Matrix I = Integral::Overlap(system);
    libint2::finalize();

    // create the expectation integral
    Matrix Iexp(system.shells.nbf(), system.shells.nbf()); Iexp << 1.00000000000000, 0.21905884826794, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.18426110292136, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000020819724, 0.00749496350753, -0.01857840079767, 0.00055563018819, 0.00051589434443, 0.04665259875736, -0.10726950274810, 0.00320814340522, 0.00297871331341, 0.00003006755256, 0.01289185741104, 0.00003006771816, 0.01289187762204, 0.00003006841610, 0.01289196280342, 0.03331208360189, 0.09264367949741, 0.03331208984284, 0.09264368428080, 0.03331215795880, 0.09264373648849, 0.21905884826794, 1.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.81227322234085, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00749496350753, 0.12218298420994, -0.18720865525510, 0.00559890926470, 0.00519850376397, 0.27979549253415, -0.50055583012191, 0.01497028367065, 0.01389968515835, 0.00650570937907, 0.10137129203631, 0.00650572871257, 0.10137141737351, 0.00650581019590, 0.10137194561970, 0.27617972355163, 0.47792536837542, 0.27617975061757, 0.47792538771137, 0.27618004602523, 0.47792559875095, 0.00000000000000, -0.00000000000000, 1.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.56975428958387, 0.00000000000000, 0.00000000000000, 0.01857840079767, 0.18720865525510, -0.25394467790767, 0.00952164651824, 0.00884070680986, 0.22308611077696, -0.22798190012263, 0.01241300664282, 0.01152529157093, 0.01276220097752, 0.09563873556964, 0.01264372242488, 0.09475070333533, 0.01230958696131, 0.09224605052800, -0.13528895033498, -0.09671451826343, -0.11780062830864, -0.08421257014100, -0.14148135440674, -0.10114122086948, 0.00000000000000, -0.00000000000000, 0.00000000000000, 1.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.56975428958387, 0.00000000000000, -0.00055563018819, -0.00559890926470, 0.00952164651824, 0.06414232298271, -0.00026440185256, -0.00667190782794, 0.01241300664282, 0.18669596546325, -0.00034469058958, -0.00017681029185, -0.00132499972208, 0.00527747625115, 0.03954884248707, -0.00622871495968, -0.04667698085248, -0.29182016982263, -0.20861457697813, 0.31001017964018, 0.22161812184035, -0.00638941435731, -0.00456762074020, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 1.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.56975428958387, -0.00051589434443, -0.00519850376397, 0.00884070680986, -0.00026440185256, 0.06418159673994, -0.00619476692989, 0.01152529157093, -0.00034469058958, 0.18674716515949, 0.00629418095973, 0.04716800099732, -0.00384803566614, -0.02883676765225, -0.00349351839855, -0.02617986092676, 0.18658240626018, 0.13338286307347, 0.16820174370050, 0.12024300160867, -0.34382778826240, -0.24579325254222, 0.18426110292136, 0.81227322234085, 0.00000000000000, 0.00000000000000, -0.00000000000000, 1.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.04665259875736, 0.27979549253415, -0.22308611077696, 0.00667190782794, 0.00619476692989, 0.49053117498101, -0.58498063252517, 0.01749520329951, 0.01624403538333, 0.06777163317596, 0.24856408680035, 0.06777172566153, 0.24856429321841, 0.06777211545139, 0.24856516318715, 0.37861759241775, 0.70631345152626, 0.37861760951114, 0.70631347083228, 0.37861779607461, 0.70631368154513, 0.00000000000000, 0.00000000000000, 0.56975428958387, 0.00000000000000, 0.00000000000000, 0.00000000000000, 1.00000000000000, 0.00000000000000, 0.00000000000000, 0.10726950274810, 0.50055583012191, -0.22798190012263, 0.01241300664282, 0.01152529157093, 0.58498063252517, -0.20708471139520, 0.02086382194302, 0.01937174756257, 0.16473593861699, 0.36767338089897, 0.16320633490468, 0.36425926955248, 0.15889217932716, 0.35462972707369, -0.18747811987459, -0.21174591765344, -0.16324347835694, -0.18437425939498, -0.19605915402808, -0.22143766230312, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.56975428958387, 0.00000000000000, 0.00000000000000, 0.00000000000000, 1.00000000000000, 0.00000000000000, -0.00320814340522, -0.01497028367065, 0.01241300664282, 0.18669596546325, -0.00034469058958, -0.01749520329951, 0.02086382194302, 0.48990719397001, -0.00057935706420, -0.00228228731366, -0.00509382651921, 0.06812215007200, 0.15204143050001, -0.08040026829996, -0.17944448445860, -0.40439294298881, -0.45673892432366, 0.42959991620700, 0.48520876413585, -0.00885419268767, -0.01000030699948, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.56975428958387, 0.00000000000000, 0.00000000000000, 0.00000000000000, 1.00000000000000, -0.00297871331341, -0.01389968515835, 0.01152529157093, -0.00034469058958, 0.18674716515949, -0.01624403538333, 0.01937174756257, -0.00057935706420, 0.48999325058600, 0.08124600216324, 0.18133257715753, -0.04967079919571, -0.11085996780508, -0.04509434423831, -0.10064557650048, 0.25855857881020, 0.29202727003001, 0.23308736211010, 0.26325896872529, -0.47646268005234, -0.53813749512743, 0.00000020819724, 0.00749496350753, 0.01857840079767, -0.00055563018819, -0.00051589434443, 0.04665259875736, 0.10726950274810, -0.00320814340522, -0.00297871331341, 1.00000000000000, 0.21905884826794, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.18426110292136, -0.00000000000000, -0.00000000000000, -0.00000000000000, 0.03331206289888, 0.09264366362950, 0.03331207932316, 0.09264367621795, 0.03331222661022, 0.09264378910649, 0.00003006794113, 0.01289190483524, 0.00003006773953, 0.01289188023021, 0.00003006800565, 0.01289191270864, 0.00749496350753, 0.12218298420994, 0.18720865525510, -0.00559890926470, -0.00519850376397, 0.27979549253415, 0.50055583012191, -0.01497028367065, -0.01389968515835, 0.21905884826794, 1.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.81227322234085, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.27617963376602, 0.47792530423244, 0.27617970499544, 0.47792535511885, 0.27618034375473, 0.47792581144913, 0.00650575474429, 0.10137158613426, 0.00650573120750, 0.10137143354791, 0.00650576227586, 0.10137163496058, -0.01857840079767, -0.18720865525510, -0.25394467790767, 0.00952164651824, 0.00884070680986, -0.22308611077696, -0.22798190012263, 0.01241300664282, 0.01152529157093, 0.00000000000000, 0.00000000000000, 1.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.56975428958387, 0.00000000000000, -0.00000000000000, 0.14148457485331, 0.10114363106980, 0.13528560429722, 0.09671213091664, 0.11780083696523, 0.08421258994254, -0.01264383756131, -0.09475134387114, -0.01230943678196, -0.09224558174552, -0.01276224012958, -0.09563857305658, 0.00055563018819, 0.00559890926470, 0.00952164651824, 0.06414232298271, -0.00026440185256, 0.00667190782794, 0.01241300664282, 0.18669596546325, -0.00034469058958, -0.00000000000000, 0.00000000000000, 0.00000000000000, 1.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.56975428958387, 0.00000000000000, 0.00648444538070, 0.00463556081614, 0.29176990579770, 0.20857865457030, -0.31005593785919, -0.22165049270314, -0.00527845824739, -0.03955610866420, 0.00622777793123, 0.04667029112897, 0.00017862883998, 0.00133862136972, 0.00051589434443, 0.00519850376397, 0.00884070680986, -0.00026440185256, 0.06418159673994, 0.00619476692989, 0.01152529157093, -0.00034469058958, 0.18674716515949, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 1.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.56975428958387, 0.34382423716100, 0.24579097638257, -0.18666338536503, -0.13344075932207, -0.16811854843712, -0.12018334288617, 0.00384650280215, 0.02882521291026, 0.00349507383102, 0.02619170352766, -0.00629428956701, -0.04716859003448, 0.04665259875736, 0.27979549253415, 0.22308611077696, -0.00667190782794, -0.00619476692989, 0.49053117498101, 0.58498063252517, -0.01749520329951, -0.01624403538333, 0.18426110292136, 0.81227322234085, -0.00000000000000, 0.00000000000000, -0.00000000000000, 1.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.37861753571400, 0.70631338748259, 0.37861758069866, 0.70631343829021, 0.37861798410433, 0.70631389391398, 0.06777185018910, 0.24856457115067, 0.06777173759652, 0.24856431985605, 0.06777188621776, 0.24856465156277, -0.10726950274810, -0.50055583012191, -0.22798190012263, 0.01241300664282, 0.01152529157093, -0.58498063252517, -0.20708471139520, 0.02086382194302, 0.01937174756257, -0.00000000000000, 0.00000000000000, 0.56975428958387, 0.00000000000000, -0.00000000000000, 0.00000000000000, 1.00000000000000, 0.00000000000000, 0.00000000000000, 0.19606381684079, 0.22144298928076, 0.18747349167656, 0.21174069297389, 0.16324352786617, 0.18437424272462, -0.16320745875188, -0.36426151411265, -0.15889131119284, -0.35462856861951, -0.16473570081169, -0.36767230918428, 0.00320814340522, 0.01497028367065, 0.01241300664282, 0.18669596546325, -0.00034469058958, 0.01749520329951, 0.02086382194302, 0.48990719397001, -0.00057935706420, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.56975428958387, 0.00000000000000, 0.00000000000000, 0.00000000000000, 1.00000000000000, 0.00000000000000, 0.00898589201512, 0.01014905667575, 0.40432330764377, 0.45666028077019, -0.42966269540959, -0.48527947863335, -0.06813467450104, -0.15206927359279, 0.08038871467786, 0.17941909224206, 0.00230575093724, 0.00514618730077, 0.00297871331341, 0.01389968515835, 0.01152529157093, -0.00034469058958, 0.18674716515949, 0.01624403538333, 0.01937174756257, -0.00057935706420, 0.48999325058600, -0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.56975428958387, 0.00000000000000, 0.00000000000000, 0.00000000000000, 1.00000000000000, 0.47645824521898, 0.53813263349061, -0.25867080835644, -0.29215403054423, -0.23297173138689, -0.26312826678137, 0.04965090261373, 0.11081548050223, 0.04511472568263, 0.10069128684498, -0.08124703754241, -0.18133462121697, 0.00003006755256, 0.00650570937907, 0.01276220097752, -0.00017681029185, 0.00629418095973, 0.06777163317596, 0.16473593861699, -0.00228228731366, 0.08124600216324, 0.03331206289888, 0.27617963376602, 0.14148457485331, 0.00648444538070, 0.34382423716100, 0.37861753571400, 0.19606381684079, 0.00898589201512, 0.47645824521898, 1.00000000000000, 0.65829196968307, 0.02008758586708, 0.15435662202230, 0.02008761620386, 0.15435671495936, 0.00046720963200, 0.03375092995988, 0.00046772999442, 0.03376620829910, 0.00001354630293, 0.00799913370385, 0.01289185741104, 0.10137129203631, 0.09563873556964, -0.00132499972208, 0.04716800099732, 0.24856408680035, 0.36767338089897, -0.00509382651921, 0.18133257715753, 0.09264366362950, 0.47792530423244, 0.10114363106980, 0.00463556081614, 0.24579097638257, 0.70631338748259, 0.22144298928076, 0.01014905667575, 0.53813263349061, 0.65829196968307, 1.00000000000000, 0.15435662202230, 0.41012514820684, 0.15435671495936, 0.41012530027419, 0.03375092995988, 0.16052583213621, 0.03376620829910, 0.16057074366971, 0.00799913370385, 0.06584499081599, 0.00003006771816, 0.00650572871257, 0.01264372242488, 0.00527747625115, -0.00384803566614, 0.06777172566153, 0.16320633490468, 0.06812215007200, -0.04967079919571, 0.03331207932316, 0.27617970499544, 0.13528560429722, 0.29176990579770, -0.18666338536503, 0.37861758069866, 0.18747349167656, 0.40432330764377, -0.25867080835644, 0.02008758586708, 0.15435662202230, 1.00000000000000, 0.65829196968307, 0.02008767297051, 0.15435688886435, 0.00001354631625, 0.00799913690093, 0.00046720770819, 0.03375087345614, 0.00046773627070, 0.03376639251511, 0.01289187762204, 0.10137141737351, 0.09475070333533, 0.03954884248707, -0.02883676765225, 0.24856429321841, 0.36425926955248, 0.15204143050001, -0.11085996780508, 0.09264367621795, 0.47792535511885, 0.09671213091664, 0.20857865457030, -0.13344075932207, 0.70631343829021, 0.21174069297389, 0.45666028077019, -0.29215403054423, 0.15435662202230, 0.41012514820684, 0.65829196968307, 1.00000000000000, 0.15435688886435, 0.41012558482445, 0.00799913690093, 0.06584500712776, 0.03375087345614, 0.16052566602580, 0.03376639251511, 0.16057128513537, 0.00003006841610, 0.00650581019590, 0.01230958696131, -0.00622871495968, -0.00349351839855, 0.06777211545139, 0.15889217932716, -0.08040026829996, -0.04509434423831, 0.03331222661022, 0.27618034375473, 0.11780083696523, -0.31005593785919, -0.16811854843712, 0.37861798410433, 0.16324352786617, -0.42966269540959, -0.23297173138689, 0.02008761620386, 0.15435671495936, 0.02008767297051, 0.15435688886435, 1.00000000000000, 0.65829196968307, 0.00046774182687, 0.03376655559380, 0.00001354648252, 0.00799917679868, 0.00046721933547, 0.03375121495552, 0.01289196280342, 0.10137194561970, 0.09224605052800, -0.04667698085248, -0.02617986092676, 0.24856516318715, 0.35462972707369, -0.17944448445860, -0.10064557650048, 0.09264378910649, 0.47792581144913, 0.08421258994254, -0.22165049270314, -0.12018334288617, 0.70631389391398, 0.18437424272462, -0.48527947863335, -0.26312826678137, 0.15435671495936, 0.41012530027419, 0.15435688886435, 0.41012558482445, 0.65829196968307, 1.00000000000000, 0.03376655559380, 0.16057176447120, 0.00799917679868, 0.06584521068916, 0.03375121495552, 0.16052666996830, 0.03331208360189, 0.27617972355163, -0.13528895033498, -0.29182016982263, 0.18658240626018, 0.37861759241775, -0.18747811987459, -0.40439294298881, 0.25855857881020, 0.00003006794113, 0.00650575474429, -0.01264383756131, -0.00527845824739, 0.00384650280215, 0.06777185018910, -0.16320745875188, -0.06813467450104, 0.04965090261373, 0.00046720963200, 0.03375092995988, 0.00001354631625, 0.00799913690093, 0.00046774182687, 0.03376655559380, 1.00000000000000, 0.65829196968307, 0.02008760253721, 0.15435667309146, 0.02008757598493, 0.15435659174823, 0.09264367949741, 0.47792536837542, -0.09671451826343, -0.20861457697813, 0.13338286307347, 0.70631345152626, -0.21174591765344, -0.45673892432366, 0.29202727003001, 0.01289190483524, 0.10137158613426, -0.09475134387114, -0.03955610866420, 0.02882521291026, 0.24856457115067, -0.36426151411265, -0.15206927359279, 0.11081548050223, 0.03375092995988, 0.16052583213621, 0.00799913690093, 0.06584500712776, 0.03376655559380, 0.16057176447120, 0.65829196968307, 1.00000000000000, 0.15435667309146, 0.41012523176825, 0.15435659174823, 0.41012509867118, 0.03331208984284, 0.27617975061757, -0.11780062830864, 0.31001017964018, 0.16820174370050, 0.37861760951114, -0.16324347835694, 0.42959991620700, 0.23308736211010, 0.00003006773953, 0.00650573120750, -0.01230943678196, 0.00622777793123, 0.00349507383102, 0.06777173759652, -0.15889131119284, 0.08038871467786, 0.04511472568263, 0.00046772999442, 0.03376620829910, 0.00046720770819, 0.03375087345614, 0.00001354648252, 0.00799917679868, 0.02008760253721, 0.15435667309146, 1.00000000000000, 0.65829196968307, 0.02008764748460, 0.15435681078815, 0.09264368428080, 0.47792538771137, -0.08421257014100, 0.22161812184035, 0.12024300160867, 0.70631347083228, -0.18437425939498, 0.48520876413585, 0.26325896872529, 0.01289188023021, 0.10137143354791, -0.09224558174552, 0.04667029112897, 0.02619170352766, 0.24856431985605, -0.35462856861951, 0.17941909224206, 0.10069128684498, 0.03376620829910, 0.16057074366971, 0.03375087345614, 0.16052566602580, 0.00799917679868, 0.06584521068916, 0.15435667309146, 0.41012523176825, 0.65829196968307, 1.00000000000000, 0.15435681078815, 0.41012545707309, 0.03331215795880, 0.27618004602523, -0.14148135440674, -0.00638941435731, -0.34382778826240, 0.37861779607461, -0.19605915402808, -0.00885419268767, -0.47646268005234, 0.00003006800565, 0.00650576227586, -0.01276224012958, 0.00017862883998, -0.00629428956701, 0.06777188621776, -0.16473570081169, 0.00230575093724, -0.08124703754241, 0.00001354630293, 0.00799913370385, 0.00046773627070, 0.03376639251511, 0.00046721933547, 0.03375121495552, 0.02008757598493, 0.15435659174823, 0.02008764748460, 0.15435681078815, 1.00000000000000, 0.65829196968307, 0.09264373648849, 0.47792559875095, -0.10114122086948, -0.00456762074020, -0.24579325254222, 0.70631368154513, -0.22143766230312, -0.01000030699948, -0.53813749512743, 0.01289191270864, 0.10137163496058, -0.09563857305658, 0.00133862136972, -0.04716859003448, 0.24856465156277, -0.36767230918428, 0.00514618730077, -0.18133462121697, 0.00799913370385, 0.06584499081599, 0.03376639251511, 0.16057128513537, 0.03375121495552, 0.16052666996830, 0.15435659174823, 0.41012509867118, 0.15435681078815, 0.41012545707309, 0.65829196968307, 1.00000000000000;

    // print the results
    std::cout << std::fixed << std::setprecision(14) << "COMPUTED INTEGRAL: " << I << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "COMPUTED INTEGRAL NORM: " << I.norm() << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "EXPECTED INTEGRAL: " << Iexp << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "EXPECTED INTEGRAL NORM: " << Iexp.norm() << std::endl;

    // return success or failure based on the error
    return (I - Iexp).norm() > 1e-8;
}
