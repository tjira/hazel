#include "../include/integral.h"

int test_int_nuclear_water_ccpvdz(int, char**) {
    // initialize the system
    System system("../example/molecule/water.xyz", "CC-PVDZ", 0, 1);

    // calculate the integral
    libint2::initialize();
    Matrix V = Integral::Nuclear(system);
    libint2::finalize();

    // create the expectation integral
    Matrix Vexp(system.shells.nbf(), system.shells.nbf()); Vexp << -62.20810380315306, 8.65099999059505, -6.07248550675346, -0.02004593794627, -0.00694481444331, -0.00801756373156, -0.00442890247181, -0.00153437072254, -0.00177138178966, -0.00014602943150, 0.00129800778720, 0.00160457053680, -0.00147389468819, 0.00085852277581, -1.88714175673026, -2.05546818505510, 2.13486081113738, -1.53994052343769, 1.51191054306725, -1.88713608472323, -2.05546538116558, 1.31211153227943, 2.73412007541423, -0.13325920553499, 8.65099999059505, -11.17494532270328, -7.40265306301978, -0.19448835360335, -0.06737960533349, -0.07778744188700, -0.17706311393601, -0.06134279576379, -0.07081802911793, -0.00511267025214, 0.04544451745040, 0.05617760128560, -0.05160248303763, 0.03005774684231, -3.61034040463669, -3.68561743381819, 2.61935723847132, -1.93060673098977, 1.86692026162760, -3.61033267223140, -3.68561325362056, 1.59503079471381, 3.39066237794426, -0.18133624916556, -6.07248550675346, -7.40265306301978, -8.04619157990638, -0.20759263585727, -0.07191957228350, -0.08302860868056, -0.21886084762735, -0.07582351224799, -0.08753540127934, -0.00545320113914, 0.04847120921456, 0.05991914764759, -0.05503930423163, 0.03205966308489, -4.14729842628262, -4.25567895757143, 2.61782775781886, -1.93783039125545, 1.86824086647015, -4.14729040394988, -4.25567434959838, 1.59108566903090, 3.39598984674474, -0.18484660725773, -0.02004593794627, -0.19448835360335, -0.20759263585727, -9.92428666367513, -0.00393990175729, -0.03976508025078, -5.47133237404344, -0.00432981006337, -0.04369974056651, -0.02966428502706, 0.02613484671330, 0.09151595296999, -0.07901322122720, -0.11068258690947, -1.92802598196149, -1.14020505393360, 0.66808443692476, -1.94421634665641, 1.88297820213777, -1.21784478780724, -0.74439560954114, -0.98084070100618, 2.12441215315116, -0.11595553927831, -0.00694481444331, -0.06737960533349, -0.07191957228350, -0.00393990175729, -9.97061199907084, 0.03501973553089, -0.00432981006337, -5.52224159768965, 0.03848486446627, -0.18893470924925, -0.05944965042325, 0.05319046821517, 0.02613484671330, 0.08654117579289, 1.29972504328901, 0.70164321254579, -1.87298801717303, -0.62217834149112, -1.32711898622237, -2.38960012952087, -1.35455797828435, 2.05318392850020, 2.34551483323489, -0.22085106607973, -0.00801756373156, -0.07778744188700, -0.08302860868056, -0.03976508025078, 0.03501973553089, -9.87246758759080, -0.04369974056651, 0.03848486446627, -5.41438588885351, 0.02613484671330, -0.02407686739289, -0.05104487735221, -0.14110701591161, -0.00978178540197, -1.33915483568939, -0.77261601258570, 1.86241627443986, -1.36273101123701, -0.65099231423836, 0.08093501679175, 0.01885328708512, -0.09539364184304, -0.18523909347816, -1.96974391688190, -0.00442890247181, -0.17706311393601, -0.21886084762735, -5.47133237404344, -0.00432981006337, -0.04369974056651, -5.40326172820832, -0.00586881613483, -0.05923174484239, -0.02073229335322, 0.02716664224442, 0.07829209079139, -0.07046887046219, -0.08588992545923, -2.22608963726919, -1.45113508977652, -0.20925004211102, -1.39386394588047, 1.33455749694214, -1.40718105557767, -0.94663195538112, -1.37902839214650, 1.51357411334216, -0.08960787638047, -0.00153437072254, -0.06134279576379, -0.07582351224799, -0.00432981006337, -5.52224159768965, 0.03848486446627, -0.00586881613483, -5.47226552422701, 0.05216338013268, -0.16723146879061, -0.05013293430181, 0.04945738373270, 0.02716664224442, 0.07985467487169, 1.49771360552484, 0.89507885184273, -1.32226197910294, -1.11364936760640, -0.93824265555428, -2.75644864958524, -1.72577909939059, 1.44197221761106, 0.99169531322731, -0.16396989241090, -0.00177138178966, -0.07081802911793, -0.08753540127934, -0.04369974056651, 0.03848486446627, -5.41438588885351, -0.05923174484239, 0.05216338013268, -5.32607496386874, 0.02716664224442, -0.01492426679044, -0.03959195973444, -0.11751551516836, -0.01016796808019, -1.54533230688649, -0.98391196677726, 1.31388770902789, -0.97404148799178, -1.13563915819943, 0.09217302907472, 0.02490391396809, -0.06893810897564, -0.12817109549448, -2.07118723405330, -0.00014602943150, -0.00511267025214, -0.00545320113914, -0.02966428502706, -0.18893470924925, 0.02613484671330, -0.02073229335322, -0.16723146879061, 0.02716664224442, -8.53627528377293, -0.03686601650993, 0.01906939926409, 0.04531220569756, 0.03165386927570, 0.67699846805205, 0.12242300056230, -0.74020696189960, -0.20366825743854, -1.27342271868084, -0.76659509009455, -0.15447933491478, -0.67672218102420, 1.64138563879820, -0.13046117944408, 0.00129800778720, 0.04544451745040, 0.04847120921456, 0.02613484671330, -0.05944965042325, -0.02407686739289, 0.02716664224442, -0.05013293430181, -0.01492426679044, -0.03686601650993, -8.46579174532848, 0.00562453614507, 0.01471885395182, -0.01633277606338, 0.49263365627193, 0.10841360663099, -1.27332672208420, -0.13559003762679, 0.15671168669284, 0.08026281717325, 0.02931499331417, -0.11663997657896, -0.15592105802578, -1.88932069775232, 0.00160457053680, 0.05617760128560, 0.05991914764759, 0.09151595296999, 0.05319046821517, -0.05104487735221, 0.07829209079139, 0.04945738373270, -0.03959195973444, 0.01906939926409, 0.00562453614507, -8.44296797725544, -0.00900608294281, -0.03068579668290, 0.16184895843778, 0.05477288661647, 0.48501224828128, -0.33035591485990, -1.48976401411842, 0.57429059134423, 0.13388538746241, -0.36055503799584, -0.78814840002564, 0.19239936970880, -0.00147389468819, -0.05160248303763, -0.05503930423163, -0.07901322122720, 0.02613484671330, -0.14110701591161, -0.07046887046219, 0.02716664224442, -0.11751551516836, 0.04531220569756, 0.01471885395182, -0.00900608294281, -8.45081592508673, -0.03161987363505, -0.70184259751978, -0.15946344952784, 0.74139422651077, -1.31004982705083, -0.22273246094919, 0.01261319092364, -0.02242057986779, 0.02976402988413, -0.09847397208190, -0.92813346572996, 0.00085852277581, 0.03005774684231, 0.03205966308489, -0.11068258690947, 0.08654117579289, -0.00978178540197, -0.08588992545923, 0.07985467487169, -0.01016796808019, 0.03165386927570, -0.01633277606338, -0.03068579668290, -0.03161987363505, -8.50393914400039, -0.23943680396080, -0.04236779576964, -0.86939860772162, -1.52401004657932, 0.44914927416269, 0.59416993451566, 0.11753020660768, -1.89189750091014, -0.09761875396651, 0.09557678880894, -1.88714175673026, -3.61034040463669, -4.14729842628262, -1.92802598196149, 1.29972504328901, -1.33915483568939, -2.22608963726919, 1.49771360552484, -1.54533230688649, 0.67699846805205, 0.49263365627193, 0.16184895843778, -0.70184259751978, -0.23943680396080, -5.33259622573576, -4.35325534352733, 1.00838544855734, -0.79081829216607, 0.73245289820101, -2.16016162240535, -2.60458674873653, 0.05493749840984, 1.45333462815555, -0.39207610482994, -2.05546818505510, -3.68561743381819, -4.25567895757143, -1.14020505393360, 0.70164321254579, -0.77261601258570, -1.45113508977652, 0.89507885184273, -0.98391196677726, 0.12242300056230, 0.10841360663099, 0.05477288661647, -0.15946344952784, -0.04236779576964, -4.35325534352733, -4.34989086896643, 0.85368718151356, -0.67198360142884, 0.62080365790146, -2.60458592849869, -2.99405984790790, 0.15155212217911, 1.50241147242980, -0.35793901510064, 2.13486081113738, 2.61935723847132, 2.61782775781886, 0.66808443692476, -1.87298801717303, 1.86241627443986, -0.20925004211102, -1.32226197910294, 1.31388770902789, -0.74020696189960, -1.27332672208420, 0.48501224828128, 0.74139422651077, -0.86939860772162, 1.00838544855734, 0.85368718151356, -5.68251415268661, 0.42564855449793, -0.41389049477358, 0.57260705652981, 0.67485442120194, -0.33891801262937, -0.67201688949641, 0.18524294528080, -1.53994052343769, -1.93060673098977, -1.93783039125545, -1.94421634665641, -0.62217834149112, -1.36273101123701, -1.39386394588047, -1.11364936760640, -0.97404148799178, -0.20366825743854, -0.13559003762679, -0.33035591485990, -1.31004982705083, -1.52401004657932, -0.79081829216607, -0.67198360142884, 0.42564855449793, -5.43909229125658, 0.31057021453908, -1.23592444323625, -1.21610669574262, -0.14390982250284, 1.62508911618306, -0.63385930875883, 1.51191054306725, 1.86692026162760, 1.86824086647015, 1.88297820213777, -1.32711898622237, -0.65099231423836, 1.33455749694214, -0.93824265555428, -1.13563915819943, -1.27342271868084, 0.15671168669284, -1.48976401411842, -0.22273246094919, 0.44914927416269, 0.73245289820101, 0.62080365790146, -0.41389049477358, 0.31057021453908, -5.39703451860760, 0.64306837173942, 0.68846806931396, 0.03279097277162, -0.89789697771144, -0.04581616606763, -1.88713608472323, -3.61033267223140, -4.14729040394988, -1.21784478780724, -2.38960012952087, 0.08093501679175, -1.40718105557767, -2.75644864958524, 0.09217302907472, -0.76659509009455, 0.08026281717325, 0.57429059134423, 0.01261319092364, 0.59416993451566, -2.16016162240535, -2.60458592849869, 0.57260705652981, -1.23592444323625, 0.64306837173942, -5.33259124407860, -4.35325196052121, 0.59687192067706, 1.34695242508433, -0.09041515720123, -2.05546538116558, -3.68561325362056, -4.25567434959838, -0.74439560954114, -1.35455797828435, 0.01885328708512, -0.94663195538112, -1.72577909939059, 0.02490391396809, -0.15447933491478, 0.02931499331417, 0.13388538746241, -0.02242057986779, 0.11753020660768, -2.60458674873653, -2.99405984790790, 0.67485442120194, -1.21610669574262, 0.68846806931396, -4.35325196052121, -4.34988835479803, 0.50440756478730, 1.14248968027541, -0.07762101718169, 1.31211153227943, 1.59503079471381, 1.59108566903090, -0.98084070100618, 2.05318392850020, -0.09539364184304, -1.37902839214650, 1.44197221761106, -0.06893810897564, -0.67672218102420, -0.11663997657896, -0.36055503799584, 0.02976402988413, -1.89189750091014, 0.05493749840984, 0.15155212217911, -0.33891801262937, -0.14390982250284, 0.03279097277162, 0.59687192067706, 0.50440756478730, -5.32132621630825, -0.44994132549013, 0.01945219005979, 2.73412007541423, 3.39066237794426, 3.39598984674474, 2.12441215315116, 2.34551483323489, -0.18523909347816, 1.51357411334216, 0.99169531322731, -0.12817109549448, 1.64138563879820, -0.15592105802578, -0.78814840002564, -0.09847397208190, -0.09761875396651, 1.45333462815555, 1.50241147242980, -0.67201688949641, 1.62508911618306, -0.89789697771144, 1.34695242508433, 1.14248968027541, -0.44994132549013, -6.08912721118918, 0.06045263783498, -0.13325920553499, -0.18133624916556, -0.18484660725773, -0.11595553927831, -0.22085106607973, -1.96974391688190, -0.08960787638047, -0.16396989241090, -2.07118723405330, -0.13046117944408, -1.88932069775232, 0.19239936970880, -0.92813346572996, 0.09557678880894, -0.39207610482994, -0.35793901510064, 0.18524294528080, -0.63385930875883, -0.04581616606763, -0.09041515720123, -0.07762101718169, 0.01945219005979, 0.06045263783498, -5.10816829890657;

    // print the results
    std::cout << std::fixed << std::setprecision(14) << "COMPUTED NUCLEAR: " << V << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "COMPUTED NUCLEAR NORM: " << V.norm() << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "EXPECTED NUCLEAR: " << Vexp << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "EXPECTED NUCLEAR NORM: " << Vexp.norm() << std::endl;

    // return success or failure based on the error
    return (V - Vexp).norm() > 1e-8;
}
