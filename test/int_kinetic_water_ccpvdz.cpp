#include "../include/integral.h"

int test_int_kinetic_water_ccpvdz(int, char**) {
    // initialize the system
    System system("../example/molecule/water.xyz", "CC-PVDZ", 0, 1);

    // calculate the integral
    libint2::initialize();
    Matrix T = Integral::Kinetic(system);
    libint2::finalize();

    // create the expectation integral
    Matrix Texp(system.shells.nbf(), system.shells.nbf()); Texp << 29.21492802501261, -8.02494220423020, 0.16670740748754, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00542929081194, 0.01720423161857, -0.01765572463916, 0.01272505842839, -0.01250075419872, 0.00542920648570, 0.01720418681650, -0.01085482975533, -0.02260163942630, 0.00109746792503, -8.02494220423020, 3.10607772144713, 0.49951317120056, -0.00000000000000, -0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.12145991215695, 0.11473862183585, -0.25073230489216, 0.18071097589277, -0.17752558884976, 0.12145932776077, 0.11473839664013, -0.15415753963608, -0.32098275184750, 0.01558596117726, 0.16670740748754, 0.49951317120056, 0.45345000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.15375441296276, 0.13216181662796, -0.20330424634663, 0.14652802229152, -0.14394517716361, 0.15375387585668, 0.13216157883452, -0.12499764725029, -0.26026679514720, 0.01263777614699, 0.00000000000000, -0.00000000000000, -0.00000000000000, 2.53596068691708, 0.00000000000000, 0.00000000000000, 0.70004312468521, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.17001698454002, 0.07204637951015, -0.23247946225589, 0.32842627896256, -0.32263711862838, 0.10453154810353, 0.04429640954776, 0.05094671300417, -0.35866733659873, 0.01741581175812, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 2.53596068691708, 0.00000000000000, 0.00000000000000, 0.70004312468521, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.12253680357538, -0.05192618301187, 0.32842627896256, -0.01350315145060, 0.23253512781945, 0.21765282479441, 0.09223281240196, -0.35866733659873, -0.52360471341055, 0.03626274262664, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 2.53596068691708, 0.00000000000000, 0.00000000000000, 0.70004312468521, 0.00000000000000, -0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.12037685095229, 0.05101088171519, -0.32263711862838, 0.23253512781945, -0.00523182434039, -0.01056856936344, -0.00447854915908, 0.01741581175812, 0.03626274262664, 0.22144211858013, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.70004312468521, 0.00000000000000, 0.00000000000000, 0.68825000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.22379005156255, 0.10416456181153, -0.02003059687127, 0.20874053165871, -0.20506106846279, 0.13759308318407, 0.06404370083424, 0.16010848031719, -0.22796186808183, 0.01106914563281, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.70004312468521, 0.00000000000000, 0.00000000000000, 0.68825000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.16129281238951, -0.07507480787727, 0.20874053165871, 0.11914593821766, 0.14779422147243, 0.28649267872246, 0.13335010003922, -0.22796186808183, -0.20506504709858, 0.02304788227813, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.70004312468521, 0.00000000000000, 0.00000000000000, 0.68825000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.15844970874195, 0.07375146645273, -0.20506106846279, 0.14779422147243, 0.12440301211553, -0.01391122651431, -0.00647508151211, 0.01106914563281, 0.02304788227813, 0.26847198930867, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 4.14750000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.12327115177587, -0.01069224674067, 0.35820312158520, -0.08369105252169, 0.43889913517597, 0.13462155851564, 0.01167683128636, 0.04858974412923, -0.64341228905740, 0.04208174058310, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 4.14750000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.08727947448420, -0.00757041418967, 0.43889913517597, -0.05925564073907, 0.04906698692124, -0.01361079315096, -0.00118057566002, 0.04208174058310, 0.06505162823624, 0.46055695689571, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 4.14750000000000, 0.00000000000000, 0.00000000000000, -0.02551871579448, -0.00221343276062, -0.08130123410415, 0.05859645952908, 0.38770048113893, -0.09919974324105, -0.00860440688882, 0.17782085014733, 0.37025387114307, -0.05707056172197, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 4.14750000000000, 0.00000000000000, 0.12109825481870, 0.01050377482268, -0.35188908572421, 0.43889913517597, -0.06807931097764, -0.00653681972807, -0.00056699195846, -0.00235937246239, 0.04208174058310, 0.22119047496688, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 4.14750000000000, 0.04109516164459, 0.00356449665491, 0.15642960973049, 0.41062817971199, -0.14631672249257, -0.10782555390299, -0.00935259415480, 0.55660801692402, 0.22933130375237, -0.03370550034932, 0.00542929081194, 0.12145991215695, 0.15375441296276, 0.17001698454002, -0.12253680357538, 0.12037685095229, 0.22379005156255, -0.16129281238951, 0.15844970874195, -0.12327115177587, -0.08727947448420, -0.02551871579448, 0.12109825481870, 0.04109516164459, 0.49928923249979, 0.20997888717551, -0.00000000000000, 0.00000000000000, -0.00000000000000, 0.03258775324380, 0.06153077288397, 0.00542892463381, -0.02820294965628, 0.01085582123251, 0.01720423161857, 0.11473862183585, 0.13216181662796, 0.07204637951015, -0.05192618301187, 0.05101088171519, 0.10416456181153, -0.07507480787727, 0.07375146645273, -0.01069224674067, -0.00757041418967, -0.00221343276062, 0.01050377482268, 0.00356449665491, 0.20997888717551, 0.18300000000000, -0.00000000000000, 0.00000000000000, -0.00000000000000, 0.06153077288397, 0.07388570101590, 0.01061874831005, -0.05516378365913, 0.02123352986871, -0.01765572463916, -0.25073230489216, -0.20330424634663, -0.23247946225589, 0.32842627896256, -0.32263711862838, -0.02003059687127, 0.20874053165871, -0.20506106846279, 0.35820312158520, 0.43889913517597, -0.08130123410415, -0.35188908572421, 0.15642960973049, -0.00000000000000, -0.00000000000000, 1.81750000000000, 0.00000000000000, 0.00000000000000, -0.00542892463381, -0.01061874831005, -0.02134179334417, 0.01839587884562, -0.00708090375641, 0.01272505842839, 0.18071097589277, 0.14652802229152, 0.32842627896256, -0.01350315145060, 0.23253512781945, 0.20874053165871, 0.11914593821766, 0.14779422147243, -0.08369105252169, -0.05925564073907, 0.05859645952908, 0.43889913517597, 0.41062817971199, 0.00000000000000, 0.00000000000000, 0.00000000000000, 1.81750000000000, 0.00000000000000, 0.02820294965628, 0.05516378365913, 0.01839587884562, -0.11336620729299, 0.03678488570633, -0.01250075419872, -0.17752558884976, -0.14394517716361, -0.32263711862838, 0.23253512781945, -0.00523182434039, -0.20506106846279, 0.14779422147243, 0.12440301211553, 0.43889913517597, 0.04906698692124, 0.38770048113893, -0.06807931097764, -0.14631672249257, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.00000000000000, 1.81750000000000, -0.01085582123251, -0.02123352986871, -0.00708090375641, 0.03678488570633, -0.03195984241742, 0.00542920648570, 0.12145932776077, 0.15375387585668, 0.10453154810353, 0.21765282479441, -0.01056856936344, 0.13759308318407, 0.28649267872246, -0.01391122651431, 0.13462155851564, -0.01361079315096, -0.09919974324105, -0.00653681972807, -0.10782555390299, 0.03258775324380, 0.06153077288397, -0.00542892463381, 0.02820294965628, -0.01085582123251, 0.49928923249979, 0.20997888717551, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.01720418681650, 0.11473839664013, 0.13216157883452, 0.04429640954776, 0.09223281240196, -0.00447854915908, 0.06404370083424, 0.13335010003922, -0.00647508151211, 0.01167683128636, -0.00118057566002, -0.00860440688882, -0.00056699195846, -0.00935259415480, 0.06153077288397, 0.07388570101590, -0.01061874831005, 0.05516378365913, -0.02123352986871, 0.20997888717551, 0.18300000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, -0.01085482975533, -0.15415753963608, -0.12499764725029, 0.05094671300417, -0.35866733659873, 0.01741581175812, 0.16010848031719, -0.22796186808183, 0.01106914563281, 0.04858974412923, 0.04208174058310, 0.17782085014733, -0.00235937246239, 0.55660801692402, 0.00542892463381, 0.01061874831005, -0.02134179334417, 0.01839587884562, -0.00708090375641, -0.00000000000000, -0.00000000000000, 1.81750000000000, 0.00000000000000, 0.00000000000000, -0.02260163942630, -0.32098275184750, -0.26026679514720, -0.35866733659873, -0.52360471341055, 0.03626274262664, -0.22796186808183, -0.20506504709858, 0.02304788227813, -0.64341228905740, 0.06505162823624, 0.37025387114307, 0.04208174058310, 0.22933130375237, -0.02820294965628, -0.05516378365913, 0.01839587884562, -0.11336620729299, 0.03678488570633, -0.00000000000000, -0.00000000000000, 0.00000000000000, 1.81750000000000, 0.00000000000000, 0.00109746792503, 0.01558596117726, 0.01263777614699, 0.01741581175812, 0.03626274262664, 0.22144211858013, 0.01106914563281, 0.02304788227813, 0.26847198930867, 0.04208174058310, 0.46055695689571, -0.05707056172197, 0.22119047496688, -0.03370550034932, 0.01085582123251, 0.02123352986871, -0.00708090375641, 0.03678488570633, -0.03195984241742, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 1.81750000000000;

    // print the results
    std::cout << std::fixed << std::setprecision(14) << "COMPUTED KINETIC: " << T << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "COMPUTED KINETIC NORM: " << T.norm() << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "EXPECTED KINETIC: " << Texp << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "EXPECTED KINETIC NORM: " << Texp.norm() << std::endl;

    // return success or failure based on the error
    return (T - Texp).norm() > 1e-8;
}
