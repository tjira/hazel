#include "../include/integral.h"

int test_integral_nuclear_ammonia_ccpvdz(int, char**) {
    // initialize the system
    System system("../example/molecule/ammonia.xyz", "CC-PVDZ", 0, 1);

    // calculate the integral
    libint2::initialize();
    Matrix I = Integral::Nuclear(system);
    libint2::finalize();

    // create the expectation integral
    Matrix Iexp(system.shells.nbf(), system.shells.nbf()); Iexp << -48.11082507102134, 6.42211934932688, -4.70246914457386, -0.01266259615097, -0.01576435779773, 0.01021998206260, -0.00300289341057, -0.00373846606702, 0.00242363545472, 0.00135692527632, -0.00109517017962, -0.00039236397202, -0.00087969521004, -0.00029968619025, -1.68163220036074, -1.90842059511581, 0.81494625990932, 1.78255399570725, 1.50305668123536, -1.68163280961147, -1.90842092071798, 2.04786720607379, -0.87489873857046, -1.06846483705934, -1.68163272168574, -1.90842087369022, -1.15631274856446, 1.21686026363656, -1.81190937064585, 6.42211934932688, -9.04577472836239, -6.24145396515335, -0.12048301642724, -0.14999589873361, 0.09724183583923, -0.10721123102060, -0.13347313392313, 0.08653016786839, 0.05144750629258, -0.04152313698271, -0.01487639176007, -0.03335344921324, -0.01136252801026, -3.36192800686687, -3.53574199034255, 0.97255993983502, 2.14665186995478, 1.84818326533284, -3.36192857343643, -3.53574228293222, 2.47498763060623, -1.09170178523646, -1.28545518047383, -3.36192845342874, -3.53574221017085, -1.42960239510634, 1.45730033128818, -2.19141133471160, -4.70246914457386, -6.24145396515335, -6.73491794676269, -0.12484043115239, -0.15542068664942, 0.10075869895087, -0.12694837512332, -0.15804499043207, 0.10246000650509, 0.05440326496422, -0.04390872687912, -0.01573107035862, -0.03526967308687, -0.01201532561382, -3.77645677757676, -4.01449631166559, 0.92282659075426, 2.04036951233656, 1.76349301625678, -3.77645729620997, -4.01449659023425, 2.35402812797363, -1.04446233825307, -1.22158793313036, -3.77645717565313, -4.01449651155706, -1.36545554583677, 1.38369828778686, -2.08459508794722, -0.01266259615097, -0.12048301642724, -0.12484043115239, -8.17591871418179, 0.03587165322816, -0.02325561898597, -4.79905799084360, 0.03679562808806, -0.02385464023274, -0.08087548909316, -0.07384972129703, 0.07162473185447, 0.12418102216025, -0.10119586392653, -0.90599112060167, -0.58785271329636, -1.25033147127534, 1.13317828657327, 0.96287993483009, -2.20257163396489, -1.37427662997242, 1.47004252336669, -1.40695681358434, -1.68462642003816, 1.16705178422428, 0.66952454133298, -0.73752022754364, -1.05373941530339, 1.58237763817252, -0.01576435779773, -0.14999589873361, -0.15542068664942, 0.03587165322816, -8.16007372606989, -0.02895191671927, 0.03679562808806, -4.78280487720764, -0.02969766547684, -0.09974314505513, 0.04443337335470, 0.02621459453452, -0.07384972129703, 0.13293741465572, -1.93555494568893, -1.22171178227197, 1.11811066092035, 0.68979568445778, 2.09260729021914, 0.85911281984053, 0.47335766625622, -1.33977105983308, -1.17575332204442, 0.69585370612514, -1.34065134384112, -0.86088062599421, -1.10585753878873, -0.61823369766762, -1.71702434834457, 0.01021998206260, 0.09724183583923, 0.10075869895087, -0.02325561898597, -0.02895191671927, -8.18596197033244, -0.02385464023274, -0.02969766547684, -4.80935994646271, -0.07384972129703, -0.16840789411526, 0.07706763929107, -0.07688133433122, 0.03987382440277, -1.54114567988924, -0.90382133565558, 0.92048560592071, 2.02766719834984, -0.02884140594789, 1.16315356939147, 0.73643617150367, -1.69609132664948, 0.73580563645901, -0.88366792126849, 1.94498499372536, 1.21064586118519, 1.63623688081483, -1.69203617421989, 0.76637544492780, -0.00300289341057, -0.10721123102060, -0.12694837512332, -4.79905799084360, 0.03679562808806, -0.02385464023274, -4.77494601688787, 0.04621713636295, -0.02996262188781, -0.06541009024498, -0.07604678587904, 0.06546766167797, 0.11628943451807, -0.08985135532736, -0.99037944447061, -0.71480079437444, -1.42104495591617, 0.71953602718835, 0.61684942285531, -2.40818818496074, -1.67801405797118, 0.30791424833052, -0.90885259539417, -1.06724831046796, 1.27649001913180, 0.82523692765879, -1.08470343030252, -0.66288594483865, 1.00288281834322, -0.00373846606702, -0.13347313392313, -0.15804499043207, 0.03679562808806, -4.78280487720764, -0.02969766547684, 0.04621713636295, -4.75453130656795, -0.03730175579749, -0.08835542270885, 0.03416925341797, 0.01667638452824, -0.07604678587904, 0.11902088153138, -2.11612754899247, -1.48987813143236, 0.70582685843449, -0.18981233179901, 1.34108988901068, 0.93983772503001, 0.58624570623335, -0.84772414582202, -1.36383459368584, 0.43860182512927, -1.46560112980087, -1.04793151665509, -0.71030522310563, -1.02061604419261, -1.09188060366198, 0.00242363545472, 0.08653016786839, 0.10246000650509, -0.02385464023274, -0.02969766547684, -4.80935994646271, -0.02996262188781, -0.03730175579749, -4.78788579334752, -0.07604678587904, -0.15554662648690, 0.06598204521414, -0.06481346175723, 0.04106009055005, -1.68549946391901, -1.11120054167533, 0.57827725380948, 1.28200462322422, -0.63291955578121, 1.27164790167484, 0.89778950662218, -1.07767953578936, 0.47495177242040, -1.18785789101786, 2.12657943142005, 1.47860230689038, 1.05188621664919, -1.06914527820393, -0.13845851055543, 0.00135692527632, 0.05144750629258, 0.05440326496422, -0.08087548909316, -0.09974314505513, -0.07384972129703, -0.06541009024498, -0.08835542270885, -0.07604678587904, -6.90239832025486, -0.05413977232717, -0.02564578093629, -0.03804530529371, 0.03629518581201, -0.56043104808230, -0.11218341987661, -1.08448276074950, 0.51979282928255, 1.08847112668840, 0.68526916585940, 0.16377094503713, -0.97074425131262, -1.15002038574871, 0.91612981919828, 0.55582939709113, 0.14472098748836, -0.34100457110303, 0.22501446084928, 1.24725376043552, -0.00109517017962, -0.04152313698271, -0.04390872687912, -0.07384972129703, 0.04443337335470, -0.16840789411526, -0.07604678587904, 0.03416925341797, -0.15554662648690, -0.05413977232717, -6.95089341911202, 0.00970618955788, 0.04690713521767, 0.02931790570899, -1.03877572384556, -0.24620777833789, 1.05854406941884, 0.94502634103757, 0.30635206083722, -0.36489842181750, -0.09477938053253, 0.92428132382453, 0.59964115349941, 0.31014967436812, 0.85430898818378, 0.18254691175398, 1.26902930225574, 0.36489655810961, 0.83276363841311, -0.00039236397202, -0.01487639176007, -0.01573107035862, 0.07162473185447, 0.02621459453452, 0.07706763929107, 0.06546766167797, 0.01667638452824, 0.06598204521414, -0.02564578093629, 0.00970618955788, -6.87506311373565, -0.03970707138405, 0.01789728856797, -0.05127976326997, -0.00270093880083, 0.50415534883407, 1.09406359504794, -1.48694952836777, 0.28504219664950, 0.05317561680478, 0.34737661059601, -0.13164405823403, 1.55833484003218, -0.43058147733514, -0.10723821660670, -1.23974361250772, 1.31637799912555, 0.98307933474351, -0.00087969521004, -0.03335344921324, -0.03526967308687, 0.12418102216025, -0.07384972129703, -0.07688133433122, 0.11628943451807, -0.07604678587904, -0.06481346175723, -0.03804530529371, 0.04690713521767, -0.03970707138405, -6.94336146479639, 0.02745648620290, -0.48573374235107, -0.12440936311230, -0.89378274491661, 1.07300769205916, 0.14417706623135, 0.84613409396289, 0.18194217665119, -1.21220465090053, 0.95190632711638, -0.76196404518913, -0.80167798118420, -0.18480004971247, 0.51148949391387, 1.22694060174001, -0.77996460477719, -0.00029968619025, -0.01136252801026, -0.01201532561382, -0.10119586392653, 0.13293741465572, 0.03987382440277, -0.08985135532736, 0.11902088153138, 0.04106009055005, 0.03629518581201, 0.02931790570899, 0.01789728856797, 0.02745648620290, -6.88146824393470, 0.48725587573862, 0.10749001251050, -1.27889679486672, 0.57006370671682, -0.93727839855190, -0.68497234530809, -0.16884269729582, -0.16113604902675, -1.55264516643775, -0.91499211917468, 0.04738657575704, 0.01799669567996, 1.11989687327182, 1.08407731018587, 0.10023956256389, -1.68163220036074, -3.36192800686687, -3.77645677757676, -0.90599112060167, -1.93555494568893, -1.54114567988924, -0.99037944447061, -2.11612754899247, -1.68549946391901, -0.56043104808230, -1.03877572384556, -0.05127976326997, -0.48573374235107, 0.48725587573862, -5.01851740944128, -4.12059148375716, 0.39483714748603, 0.89222813114745, 0.80866438436879, -1.80433548556481, -2.26194339781350, 0.59999757714357, -0.70548979404337, -0.70561882927896, -1.80433532696841, -2.26194325514395, -0.61193459830257, 0.08568621645075, -0.98681531275724, -1.90842059511581, -3.53574199034255, -4.01449631166559, -0.58785271329636, -1.22171178227197, -0.90382133565558, -0.71480079437444, -1.48987813143236, -1.11120054167533, -0.11218341987661, -0.24620777833789, -0.00270093880083, -0.12440936311230, 0.10749001251050, -4.12059148375716, -4.15394579277852, 0.33743965133077, 0.76344132304492, 0.69368730255605, -2.26194341262313, -2.67790286287983, 0.73683839139339, -0.76688432857856, -0.77178053042105, -2.26194325705562, -2.67790272807660, -0.69342923389825, 0.16682582903994, -1.10363598940833, 0.81494625990932, 0.97255993983502, 0.92282659075426, -1.25033147127534, 1.11811066092035, 0.92048560592071, -1.42104495591617, 0.70582685843449, 0.57827725380948, -1.08448276074950, 1.05854406941884, 0.50415534883407, -0.89378274491661, -1.27889679486672, 0.39483714748603, 0.33743965133077, -4.91048419583531, -0.21512095950212, -0.19326994052159, -0.11875622362126, -0.06338097862105, -0.09116814669702, -0.22217293343160, -0.21387986302986, 0.53724788115448, 0.58600485220516, 0.21133469916211, 0.02739783256259, 0.66744912852145, 1.78255399570725, 2.14665186995478, 2.04036951233656, 1.13317828657327, 0.68979568445778, 2.02766719834984, 0.71953602718835, -0.18981233179901, 1.28200462322422, 0.51979282928255, 0.94502634103757, 1.09406359504794, 1.07300769205916, 0.57006370671682, 0.89222813114745, 0.76344132304492, -0.21512095950212, -5.29572031566372, -0.42570970192457, 0.84372272653280, 0.95792023243732, -0.49565046058997, 0.53786217110076, 0.72352194543245, 0.41546872927750, 0.53398682505192, 0.22055485324831, -0.22153729369204, 0.36016729723090, 1.50305668123536, 1.84818326533284, 1.76349301625678, 0.96287993483009, 2.09260729021914, -0.02884140594789, 0.61684942285531, 1.34108988901068, -0.63291955578121, 1.08847112668840, 0.30635206083722, -1.48694952836777, 0.14417706623135, -0.93727839855190, 0.80866438436879, 0.69368730255605, -0.19326994052159, -0.42570970192457, -5.17969425211932, 0.79349838556773, 0.89725081976235, -0.46523155282692, 0.69489229429163, 0.49494582424724, 0.94570656526019, 1.04792345582671, 0.69281079097815, 0.04262301817315, 0.95184230730282, -1.68163280961147, -3.36192857343643, -3.77645729620997, -2.20257163396489, 0.85911281984053, 1.16315356939147, -2.40818818496074, 0.93983772503001, 1.27164790167484, 0.68526916585940, -0.36489842181750, 0.28504219664950, 0.84613409396289, -0.68497234530809, -1.80433548556481, -2.26194341262313, -0.11875622362126, 0.84372272653280, 0.79349838556773, -5.01851742248235, -4.12059141897515, 1.03807868217324, -0.49422383396033, -0.53295553920489, -1.80433080397815, -2.26193906037628, -0.86435090235857, 0.62975416611921, -0.46033596052104, -1.90842092071798, -3.53574228293222, -4.01449659023425, -1.37427662997242, 0.47335766625622, 0.73643617150367, -1.67801405797118, 0.58624570623335, 0.89778950662218, 0.16377094503713, -0.09477938053253, 0.05317561680478, 0.18194217665119, -0.16884269729582, -2.26194339781350, -2.67790286287983, -0.06338097862105, 0.95792023243732, 0.89725081976235, -4.12059141897515, -4.15394564523029, 0.88864434595863, -0.42463319207677, -0.45596986868575, -2.26193904747834, -2.67789892193022, -0.94330063828301, 0.70540591044057, -0.58246855427553, 2.04786720607379, 2.47498763060623, 2.35402812797363, 1.47004252336669, -1.33977105983308, -1.69609132664948, 0.30791424833052, -0.84772414582202, -1.07767953578936, -0.97074425131262, 0.92428132382453, 0.34737661059601, -1.21220465090053, -0.16113604902675, 0.59999757714357, 0.73683839139339, -0.09116814669702, -0.49565046058997, -0.46523155282692, 1.03807868217324, 0.88864434595863, -5.45969235536093, 0.29410076638466, 0.33324324195999, 1.00357659644380, 1.13634750578700, 0.87187951268395, -0.74255375625217, 0.42192141310435, -0.87489873857046, -1.09170178523646, -1.04446233825307, -1.40695681358434, -1.17575332204442, 0.73580563645901, -0.90885259539417, -1.36383459368584, 0.47495177242040, -1.15002038574871, 0.59964115349941, -0.13164405823403, 0.95190632711638, -1.55264516643775, -0.70548979404337, -0.76688432857856, -0.22217293343160, 0.53786217110076, 0.69489229429163, -0.49422383396033, -0.42463319207677, 0.29410076638466, -4.93937128454597, -0.15364495772133, -0.58966993860936, -0.65223408125329, -0.65788664275233, 0.26265409056777, -0.24800237063617, -1.06846483705934, -1.28545518047383, -1.22158793313036, -1.68462642003816, 0.69585370612514, -0.88366792126849, -1.06724831046796, 0.43860182512927, -1.18785789101786, 0.91612981919828, 0.31014967436812, 1.55833484003218, -0.76196404518913, -0.91499211917468, -0.70561882927896, -0.77178053042105, -0.21387986302986, 0.72352194543245, 0.49494582424724, -0.53295553920489, -0.45596986868575, 0.33324324195999, -0.15364495772133, -4.98683548410672, -0.02693307213174, -0.09994152902789, 0.10945475416144, -0.06366202325538, -0.19289732561955, -1.68163272168574, -3.36192845342874, -3.77645717565313, 1.16705178422428, -1.34065134384112, 1.94498499372536, 1.27649001913180, -1.46560112980087, 2.12657943142005, 0.55582939709113, 0.85430898818378, -0.43058147733514, -0.80167798118420, 0.04738657575704, -1.80433532696841, -2.26194325705562, 0.53724788115448, 0.41546872927750, 0.94570656526019, -1.80433080397815, -2.26193904747834, 1.00357659644380, -0.58966993860936, -0.02693307213174, -5.01851733551540, -4.12059135629285, -0.63361210117977, 0.59709262402711, -0.92082687071202, -1.90842087369022, -3.53574221017085, -4.01449651155706, 0.66952454133298, -0.86088062599421, 1.21064586118519, 0.82523692765879, -1.04793151665509, 1.47860230689038, 0.14472098748836, 0.18254691175398, -0.10723821660670, -0.18480004971247, 0.01799669567996, -2.26194325514395, -2.67790272807660, 0.58600485220516, 0.53398682505192, 1.04792345582671, -2.26193906037628, -2.67789892193022, 1.13634750578700, -0.65223408125329, -0.09994152902789, -4.12059135629285, -4.15394559428600, -0.54385617429394, 0.51053461007977, -0.78834347213773, -1.15631274856446, -1.42960239510634, -1.36545554583677, -0.73752022754364, -1.10585753878873, 1.63623688081483, -1.08470343030252, -0.71030522310563, 1.05188621664919, -0.34100457110303, 1.26902930225574, -1.23974361250772, 0.51148949391387, 1.11989687327182, -0.61193459830257, -0.69342923389825, 0.21133469916211, 0.22055485324831, 0.69281079097815, -0.86435090235857, -0.94330063828301, 0.87187951268395, -0.65788664275233, 0.10945475416144, -0.63361210117977, -0.54385617429394, -5.03216013045920, 0.22592647106406, -0.33764421857682, 1.21686026363656, 1.45730033128818, 1.38369828778686, -1.05373941530339, -0.61823369766762, -1.69203617421989, -0.66288594483865, -1.02061604419261, -1.06914527820393, 0.22501446084928, 0.36489655810961, 1.31637799912555, 1.22694060174001, 1.08407731018587, 0.08568621645075, 0.16682582903994, 0.02739783256259, -0.22153729369204, 0.04262301817315, 0.62975416611921, 0.70540591044057, -0.74255375625217, 0.26265409056777, -0.06366202325538, 0.59709262402711, 0.51053461007977, 0.22592647106406, -5.03256399980543, 0.33326535612247, -1.81190937064585, -2.19141133471160, -2.08459508794722, 1.58237763817252, -1.71702434834457, 0.76637544492780, 1.00288281834322, -1.09188060366198, -0.13845851055543, 1.24725376043552, 0.83276363841311, 0.98307933474351, -0.77996460477719, 0.10023956256389, -0.98681531275724, -1.10363598940833, 0.66744912852145, 0.36016729723090, 0.95184230730282, -0.46033596052104, -0.58246855427553, 0.42192141310435, -0.24800237063617, -0.19289732561955, -0.92082687071202, -0.78834347213773, -0.33764421857682, 0.33326535612247, -5.32117467209467;

    // print the results
    std::cout << std::fixed << std::setprecision(14) << "COMPUTED INTEGRAL: " << I << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "COMPUTED INTEGRAL NORM: " << I.norm() << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "EXPECTED INTEGRAL: " << Iexp << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "EXPECTED INTEGRAL NORM: " << Iexp.norm() << std::endl;

    // return success or failure based on the error
    return (I - Iexp).norm() > 1e-8;
}
