#include "../include/integral.h"

int test_integral_kinetic_ethane_321g(int, char**) {
    // initialize the system
    System system("../example/molecule/ethane.xyz", "3-21G", 0, 1);

    // calculate the integral
    libint2::initialize();
    Matrix I = Integral::Kinetic(system);
    libint2::finalize();

    // create the expectation integral
    Matrix Iexp(system.shells.nbf(), system.shells.nbf()); Iexp << 16.57897377972110, -1.43502704208436, -0.00000000000000, -0.00000000000000, -0.00000000000000, 0.10274966905493, -0.00000000000000, -0.00000000000000, -0.00000000000000, -0.00000000425088, -0.00965921737063, 0.02374393044391, -0.00071011733919, -0.00065933336050, -0.00142871730417, -0.03076769615044, 0.00092017935173, 0.00085437280680, -0.00003103193230, -0.00456540213391, -0.00003103213696, -0.00456540487702, -0.00003103299953, -0.00456541643804, -0.04428054749760, 0.02170319605236, -0.04428055145127, 0.02170319904007, -0.04428059460307, 0.02170323164909, -1.43502704208436, 1.35736735247949, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.34641224940510, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00965921737063, -0.06269104523552, 0.04997882222973, -0.00149473265774, -0.00138783698396, 0.01390919418908, -0.15706728869104, 0.00469746175269, 0.00436152319103, -0.00547971008154, -0.01774123041832, -0.00547972779120, -0.01774122877761, -0.00547980243069, -0.01774122186225, -0.01384854144783, 0.10419344237756, -0.01384852273767, 0.10419345292121, -0.01384831852793, 0.10419356799842, -0.00000000000000, 0.00000000000000, 2.58667015032044, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.41750973612682, -0.00000000000000, 0.00000000000000, -0.02374393044391, -0.04997882222973, -0.03130397918357, 0.00033625338730, 0.00031220625606, 0.06605489403314, -0.20206425354108, 0.00758069734181, 0.00703856444207, -0.01063618442861, -0.00032355929276, -0.01053744364516, -0.00032052682436, -0.01025897399881, -0.00031193855085, -0.06006313608521, -0.04777178619403, -0.05229899992276, -0.04159649558427, -0.06281250024620, -0.04995836008126, -0.00000000000000, 0.00000000000000, 0.00000000000000, 2.58667015032044, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.41750973612682, 0.00000000000000, 0.00071011733919, 0.00149473265774, 0.00033625338730, -0.02007085565798, -0.00000933725258, -0.00197552489054, 0.00758069734181, 0.05118199725111, -0.00021050460307, 0.00014735599888, 0.00000448266040, -0.00439831773558, -0.00013378755453, 0.00519109414623, 0.00015784252748, -0.12955702981706, -0.10304441512299, 0.13763273247218, 0.10946747274297, -0.00283666418501, -0.00225616064046, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 2.58667015032044, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.41750973612682, 0.00065933336050, 0.00138783698396, 0.00031220625606, -0.00000933725258, -0.02006946871993, -0.00183424540277, 0.00703856444207, -0.00021050460307, 0.05121326521159, -0.00524565234733, -0.00015957598093, 0.00320700325536, 0.00009755027915, 0.00291154484125, 0.00008852962086, 0.08283547496351, 0.06588398237520, 0.07467517879237, 0.05939359738195, -0.15264684965337, -0.12140873632417, 0.10274966905493, 0.34641224940510, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.29378550000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, -0.00142871730417, 0.01390919418908, -0.06605489403314, 0.00197552489054, 0.00183424540277, 0.05766992942045, -0.18418002552120, 0.00550833106438, 0.00511440325563, -0.01712710723647, -0.00373574307483, -0.01712711172198, -0.00373571014147, -0.01712713062622, -0.00373557134028, 0.08980645237281, 0.13981866734550, 0.08980646288876, 0.13981867571636, 0.08980657766379, 0.13981876707897, -0.00000000000000, -0.00000000000000, 0.41750973612682, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.48964250000000, 0.00000000000000, 0.00000000000000, 0.03076769615044, 0.15706728869104, -0.20206425354108, 0.00758069734181, 0.00703856444207, 0.18418002552120, -0.23475164446515, 0.01130777594560, 0.01049910134924, -0.00741539839724, 0.05444484729129, -0.00734648625190, 0.05393935139976, -0.00715204980926, 0.05251367401160, -0.10704783325290, -0.08521167637549, -0.09321013730544, -0.07419666077054, -0.11194755347747, -0.08911188887541, -0.00000000000000, 0.00000000000000, -0.00000000000000, 0.41750973612682, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.48964250000000, 0.00000000000000, -0.00092017935173, -0.00469746175269, 0.00758069734181, 0.05118199725111, -0.00021050460307, -0.00550833106438, 0.01130777594560, 0.14300408616229, -0.00031399998966, 0.00010273453279, -0.00075429068672, -0.00306641552392, 0.02251422772888, 0.00361897436359, -0.02657219189659, -0.23090368283335, -0.18380278514393, 0.24529658139546, 0.19525974066887, -0.00505564361081, -0.00402436621119, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.41750973612682, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.48964250000000, -0.00085437280680, -0.00436152319103, 0.00703856444207, -0.00021050460307, 0.05121326521159, -0.00511440325563, 0.01049910134924, -0.00031399998966, 0.14305072713416, -0.00365719514079, 0.02685161609508, 0.00223585587916, -0.01641609496157, 0.00202978521331, -0.01490362649141, 0.14763395135974, 0.11751883343198, 0.13309018678798, 0.10594177550276, -0.27205478683000, -0.21655958686849, -0.00000000425088, -0.00965921737063, -0.02374393044391, 0.00071011733919, 0.00065933336050, -0.00142871730417, 0.03076769615044, -0.00092017935173, -0.00085437280680, 16.57897377972110, -1.43502704208436, -0.00000000000000, 0.00000000000000, 0.00000000000000, 0.10274966905493, -0.00000000000000, 0.00000000000000, 0.00000000000000, -0.04428053438210, 0.02170318614124, -0.04428054478699, 0.02170319400400, -0.04428063809392, 0.02170326451440, -0.00003103241253, -0.00456540857048, -0.00003103216337, -0.00456540523101, -0.00003103249225, -0.00456540963908, -0.00965921737063, -0.06269104523552, -0.04997882222973, 0.00149473265774, 0.00138783698396, 0.01390919418908, 0.15706728869104, -0.00469746175269, -0.00436152319103, -1.43502704208436, 1.35736735247949, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.34641224940510, 0.00000000000000, -0.00000000000000, 0.00000000000000, -0.01384860351485, 0.10419340740122, -0.01384855427536, 0.10419343514893, -0.01384811271277, 0.10419368398009, -0.00547975163649, -0.01774122656841, -0.00547973007658, -0.01774122856588, -0.00547975853548, -0.01774122592923, 0.02374393044391, 0.04997882222973, -0.03130397918357, 0.00033625338730, 0.00031220625606, -0.06605489403314, -0.20206425354108, 0.00758069734181, 0.00703856444207, -0.00000000000000, 0.00000000000000, 2.58667015032044, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.41750973612682, -0.00000000000000, -0.00000000000000, 0.06281370904063, 0.04995952481846, 0.06006164106193, 0.04777060586348, 0.05229935725438, 0.04159653623881, 0.01053754065782, 0.00032049111461, 0.01025884571657, 0.00031204885528, 0.01063621922530, 0.00032348105647, -0.00071011733919, -0.00149473265774, 0.00033625338730, -0.02007085565798, -0.00000933725258, 0.00197552489054, 0.00758069734181, 0.05118199725111, -0.00021050460307, 0.00000000000000, -0.00000000000000, 0.00000000000000, 2.58667015032044, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.41750973612682, 0.00000000000000, 0.00287884432530, 0.00228971822736, 0.12953469399592, 0.10302666898738, -0.13765374407082, -0.10948354347452, 0.00439913658513, 0.00013379632243, -0.00519031163531, -0.00015787651448, -0.00014887163090, -0.00000452765700, -0.00065933336050, -0.00138783698396, 0.00031220625606, -0.00000933725258, -0.02006946871993, 0.00183424540277, 0.00703856444207, -0.00021050460307, 0.05121326521159, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.00000000000000, 2.58667015032044, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.41750973612682, 0.15264473612435, 0.12140754939147, -0.08287141347699, -0.06591257848711, -0.07463862101758, -0.05936417323202, -0.00320572606786, -0.00009749966847, -0.00291284027332, -0.00008860143704, 0.00524574393073, 0.00015953965904, -0.00142871730417, 0.01390919418908, 0.06605489403314, -0.00197552489054, -0.00183424540277, 0.05766992942045, 0.18418002552120, -0.00550833106438, -0.00511440325563, 0.10274966905493, 0.34641224940510, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.29378550000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.08980641748831, 0.13981863957692, 0.08980644516315, 0.13981866160650, 0.08980669334090, 0.13981885915962, -0.01712711776145, -0.00373566579820, -0.01712711230082, -0.00373570589152, -0.01712711950880, -0.00373565296867, -0.03076769615044, -0.15706728869104, -0.20206425354108, 0.00758069734181, 0.00703856444207, -0.18418002552120, -0.23475164446515, 0.01130777594560, 0.01049910134924, -0.00000000000000, 0.00000000000000, 0.41750973612682, -0.00000000000000, -0.00000000000000, 0.00000000000000, 0.48964250000000, -0.00000000000000, 0.00000000000000, 0.11195015300079, 0.08911400682222, 0.10704518789876, 0.08520957272953, 0.09321024091083, 0.07419668491796, 0.00734645767186, -0.05393976942056, 0.00715224460068, -0.05251324946008, 0.00741522531513, -0.05444486425871, 0.00092017935173, 0.00469746175269, 0.00758069734181, 0.05118199725111, -0.00021050460307, 0.00550833106438, 0.01130777594560, 0.14300408616229, -0.00031399998966, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.41750973612682, 0.00000000000000, -0.00000000000000, -0.00000000000000, 0.48964250000000, 0.00000000000000, 0.00513083955087, 0.00408422551005, 0.23086391602097, 0.18377113468582, -0.24533262588123, -0.19528827910680, 0.00306694624152, -0.02251838647717, -0.00361857263430, 0.02656830380442, -0.00010378844802, 0.00076204669767, 0.00085437280680, 0.00436152319103, 0.00703856444207, -0.00021050460307, 0.05121326521159, 0.00511440325563, 0.01049910134924, -0.00031399998966, 0.14305072713416, 0.00000000000000, 0.00000000000000, -0.00000000000000, 0.00000000000000, 0.41750973612682, 0.00000000000000, 0.00000000000000, 0.00000000000000, 0.48964250000000, 0.27205210176065, 0.21655756783224, -0.14769802939506, -0.11756984339780, -0.13302427049841, -0.10588922191559, -0.00223493618007, 0.01640953335704, -0.00203076902539, 0.01491032345513, 0.00365716166317, -0.02685200541609, -0.00003103193230, -0.00547971008154, -0.01063618442861, 0.00014735599888, -0.00524565234733, -0.01712710723647, -0.00741539839724, 0.00010273453279, -0.00365719514079, -0.04428053438210, -0.01384860351485, 0.06281370904063, 0.00287884432530, 0.15264473612435, 0.08980641748831, 0.11195015300079, 0.00513083955087, 0.27205210176065, 1.54940494556963, 0.29315085381580, -0.02217836883626, -0.00625045101731, -0.02217839791786, -0.00625042991962, -0.00046001694068, -0.01217791602098, -0.00046059173078, -0.01218098185302, -0.00000763020963, -0.00429289437118, -0.00456540213391, -0.01774123041832, -0.00032355929276, 0.00000448266040, -0.00015957598093, -0.00373574307483, 0.05444484729129, -0.00075429068672, 0.02685161609508, 0.02170318614124, 0.10419340740122, 0.04995952481846, 0.00228971822736, 0.12140754939147, 0.13981863957692, 0.08911400682222, 0.00408422551005, 0.21655756783224, 0.29315085381580, 0.27478737000000, -0.00625045101731, 0.03245573682122, -0.00625042991962, 0.03245577852387, -0.01217791602098, -0.01325331954049, -0.01218098185302, -0.01325024148734, -0.00429289437118, -0.01325308805338, -0.00003103213696, -0.00547972779120, -0.01053744364516, -0.00439831773558, 0.00320700325536, -0.01712711172198, -0.00734648625190, -0.00306641552392, 0.00223585587916, -0.04428054478699, -0.01384855427536, 0.06006164106193, 0.12953469399592, -0.08287141347699, 0.08980644516315, 0.10704518789876, 0.23086391602097, -0.14769802939506, -0.02217836883626, -0.00625045101731, 1.54940494556963, 0.29315085381580, -0.02217845233576, -0.00625039044130, -0.00000763021852, -0.00429289580437, -0.00046001481576, -0.01217790467983, -0.00046059866391, -0.01218101880953, -0.00456540487702, -0.01774122877761, -0.00032052682436, -0.00013378755453, 0.00009755027915, -0.00373571014147, 0.05393935139976, 0.02251422772888, -0.01641609496157, 0.02170319400400, 0.10419343514893, 0.04777060586348, 0.10302666898738, -0.06591257848711, 0.13981866160650, 0.08520957272953, 0.18377113468582, -0.11756984339780, -0.00625045101731, 0.03245573682122, 0.29315085381580, 0.27478737000000, -0.00625039044130, 0.03245585655842, -0.00429289580437, -0.01325308943734, -0.01217790467983, -0.01325333092050, -0.01218101880953, -0.01325020436265, -0.00003103299953, -0.00547980243069, -0.01025897399881, 0.00519109414623, 0.00291154484125, -0.01712713062622, -0.00715204980926, 0.00361897436359, 0.00202978521331, -0.04428063809392, -0.01384811271277, 0.05229935725438, -0.13765374407082, -0.07463862101758, 0.08980669334090, 0.09321024091083, -0.24533262588123, -0.13302427049841, -0.02217839791786, -0.00625042991962, -0.02217845233576, -0.00625039044130, 1.54940494556963, 0.29315085381580, -0.00046060480158, -0.01218105152540, -0.00000763032940, -0.00429291368976, -0.00046002765852, -0.01217797322357, -0.00456541643804, -0.01774122186225, -0.00031193855085, 0.00015784252748, 0.00008852962086, -0.00373557134028, 0.05251367401160, -0.02657219189659, -0.01490362649141, 0.02170326451440, 0.10419368398009, 0.04159653623881, -0.10948354347452, -0.05936417323202, 0.13981885915962, 0.07419668491796, -0.19528827910680, -0.10588922191559, -0.00625042991962, 0.03245577852387, -0.00625039044130, 0.03245585655842, 0.29315085381580, 0.27478737000000, -0.01218105152540, -0.01325017149749, -0.00429291368976, -0.01325310670841, -0.01217797322357, -0.01325326214117, -0.04428054749760, -0.01384854144783, -0.06006313608521, -0.12955702981706, 0.08283547496351, 0.08980645237281, -0.10704783325290, -0.23090368283335, 0.14763395135974, -0.00003103241253, -0.00547975163649, 0.01053754065782, 0.00439913658513, -0.00320572606786, -0.01712711776145, 0.00734645767186, 0.00306694624152, -0.00223493618007, -0.00046001694068, -0.01217791602098, -0.00000763021852, -0.00429289580437, -0.00046060480158, -0.01218105152540, 1.54940494556963, 0.29315085381580, -0.02217838481668, -0.00625043942407, -0.02217835936299, -0.00625045788984, 0.02170319605236, 0.10419344237756, -0.04777178619403, -0.10304441512299, 0.06588398237520, 0.13981866734550, -0.08521167637549, -0.18380278514393, 0.11751883343198, -0.00456540857048, -0.01774122656841, 0.00032049111461, 0.00013379632243, -0.00009749966847, -0.00373566579820, -0.05393976942056, -0.02251838647717, 0.01640953335704, -0.01217791602098, -0.01325331954049, -0.00429289580437, -0.01325308943734, -0.01218105152540, -0.01325017149749, 0.29315085381580, 0.27478737000000, -0.00625043942407, 0.03245575973694, -0.00625045788984, 0.03245572323666, -0.04428055145127, -0.01384852273767, -0.05229899992276, 0.13763273247218, 0.07467517879237, 0.08980646288876, -0.09321013730544, 0.24529658139546, 0.13309018678798, -0.00003103216337, -0.00547973007658, 0.01025884571657, -0.00519031163531, -0.00291284027332, -0.01712711230082, 0.00715224460068, -0.00361857263430, -0.00203076902539, -0.00046059173078, -0.01218098185302, -0.00046001481576, -0.01217790467983, -0.00000763032940, -0.00429291368976, -0.02217838481668, -0.00625043942407, 1.54940494556963, 0.29315085381580, -0.02217842790436, -0.00625040816545, 0.02170319904007, 0.10419345292121, -0.04159649558427, 0.10946747274297, 0.05939359738195, 0.13981867571636, -0.07419666077054, 0.19525974066887, 0.10594177550276, -0.00456540523101, -0.01774122856588, 0.00031204885528, -0.00015787651448, -0.00008860143704, -0.00373570589152, -0.05251324946008, 0.02656830380442, 0.01491032345513, -0.01218098185302, -0.01325024148734, -0.01217790467983, -0.01325333092050, -0.00429291368976, -0.01325310670841, -0.00625043942407, 0.03245575973694, 0.29315085381580, 0.27478737000000, -0.00625040816545, 0.03245582152412, -0.04428059460307, -0.01384831852793, -0.06281250024620, -0.00283666418501, -0.15264684965337, 0.08980657766379, -0.11194755347747, -0.00505564361081, -0.27205478683000, -0.00003103249225, -0.00547975853548, 0.01063621922530, -0.00014887163090, 0.00524574393073, -0.01712711950880, 0.00741522531513, -0.00010378844802, 0.00365716166317, -0.00000763020963, -0.00429289437118, -0.00046059866391, -0.01218101880953, -0.00046002765852, -0.01217797322357, -0.02217835936299, -0.00625045788984, -0.02217842790436, -0.00625040816545, 1.54940494556963, 0.29315085381580, 0.02170323164909, 0.10419356799842, -0.04995836008126, -0.00225616064046, -0.12140873632417, 0.13981876707897, -0.08911188887541, -0.00402436621119, -0.21655958686849, -0.00456540963908, -0.01774122592923, 0.00032348105647, -0.00000452765700, 0.00015953965904, -0.00373565296867, -0.05444486425871, 0.00076204669767, -0.02685200541609, -0.00429289437118, -0.01325308805338, -0.01218101880953, -0.01325020436265, -0.01217797322357, -0.01325326214117, -0.00625045788984, 0.03245572323666, -0.00625040816545, 0.03245582152412, 0.29315085381580, 0.27478737000000;

    // print the results
    std::cout << std::fixed << std::setprecision(14) << "COMPUTED INTEGRAL: " << I << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "COMPUTED INTEGRAL NORM: " << I.norm() << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "EXPECTED INTEGRAL: " << Iexp << std::endl;
    std::cout << std::fixed << std::setprecision(14) << "EXPECTED INTEGRAL NORM: " << Iexp.norm() << std::endl;

    // return success or failure based on the error
    return (I - Iexp).norm() > 1e-8;
}
